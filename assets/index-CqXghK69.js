import{a as i,p as o,w as X,q as Y,O as Z}from"./chunk-OIYGIGL5-DHSEYwXb.js";import{v as g,u as Q,a as v,b as z,c as V,d as q,e as K,L as F,S as $,B as ee,W as te,F as ne,A as re,f as se}from"./SoulContext-7UMgvl1F.js";import{U as ae}from"./UIContext-0ViXxJJZ.js";import{u as B,L as oe}from"./LanguageContext-BViog3Sf.js";import{u as ie}from"./use-isomorphic-effect-D9uMbDtW.js";import{a as j,C as le}from"./notifications.store-V0zmloTj.js";import"./factory-DCCmYdVK.js";import"./polymorphic-factory-C_t3okJG.js";function H(e){ie(()=>{typeof e=="string"&&e.trim().length>0&&(document.title=e.trim())},[e])}const ce="/assets/IMAGE_DEPTH_4-O8gd5XC3.png",ue="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",de=(e,n)=>{const t=i.useRef(e);t.current=e,i.useEffect(()=>{let a=performance.now();const r=()=>{performance.now()-a>=n&&(t.current(),a=performance.now()),u=requestAnimationFrame(r)};let u=requestAnimationFrame(r);return()=>{cancelAnimationFrame(u)}},[])},D=(e,n={})=>{const t=i.useRef(null),a=i.useRef(null),r=i.useRef(null),u=s=>{let{x:c,y:d}=typeof n.size=="function"?n.size(s):g(n.size?.x&&n.size?.x>0?n.size?.x:s.clientWidth,n.size?.y&&n.size?.y>0?n.size?.y:s.clientHeight);s.width=c,s.height=d};i.useEffect(()=>{const s=t.current;if(!s)return;u(s);const c=s.getContext("2d",{alpha:!0,desynchronized:!0});return c?(a.current=c,r.current=e(c),()=>{r.current?.destroy?.(),a.current=null}):n?.onFail?.()},[e,t]);const m=i.useCallback(()=>{r.current?.update?.(1),a.current&&a.current.clearRect(0,0,a.current.canvas.width,a.current.canvas.height),r.current?.draw()},[n.noClear]);de(m,n.delay||30);const p=i.useCallback(()=>{t.current&&u(t.current)},[t,n.size]);return B("resize",p),{ref:t}},O=()=>{const e=i.useRef(null),n=i.useCallback(()=>{e.current?.play().catch(()=>{})},[e]);return B("click",n,{once:!0}),e};class he{siner;alpha;xstretch;ystretch;o_insurance;depth;b_insurance;OBSPEED;constructor(){this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}shouldDraw(){return this.siner<150&&this.siner>2}getAlpha(){return Math.max(0,.2+this.alpha-this.o_insurance+this.b_insurance)}}const Ae=()=>{H("ARE WE CONNECTED?");const e=i.useCallback(a=>{let r=[],u=new Image;u.src=ce;let m=0,p=0,s=.5;return{update(){if(m+=1,p+=s,p>=20){let c=new he;c.depth=5+m,c.OBSPEED=.01*s,c.destroy=()=>r=r.filter(d=>d!==c),r.unshift(c),m>=6e4&&(m=0),p=0}for(let c of r)c.step()},draw(){if(u.complete)for(let c of r){if(!c.shouldDraw())continue;let d=c.getAlpha();a.globalAlpha=d;const A=u.width*c.xstretch,x=u.height*c.ystretch;a.drawImage(u,160-A/2,120-x/2,A,x)}}}},[]),{ref:n}=D(e,{size:g(320,240)}),t=O();return o.jsxs("div",{className:"pageBackground",children:[o.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"crisp-edges"},ref:n}),o.jsx("audio",{src:ue,ref:t,autoPlay:!0,loop:!0})]})},ge="/assets/tree-DOnJeJ13.gif",fe="/assets/man-DVTDGMKe.ogg",me=()=>{const e=O();return H("* "),o.jsxs("div",{className:"pageBackground",children:[o.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${ge}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),o.jsx("audio",{src:fe,loop:!0,autoPlay:!0,ref:e})]})},_=()=>{let e=49734321;return()=>(e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,(e&268435455)/268435456)},pe=()=>{const{myBurdenIsDead:e}=Q(),n=a=>[1,-1].map(r=>Array(256).fill(0).map((u,m)=>{const p=a()/2*100*r+(r==-1?100:0),s=`${p}%`,c=Math.abs(p-50)/50,x=2+c*10;if(a()>c)return null;const b=c*.5,k=a();return{key:r*(m+1),color:r*(a()>.2?1:-1)>0?"#97257a":"#7463aa",size:x,top:s,left:a()*110-5+"%",opacity:b,animrand:k,dir:r}})).flat().filter(r=>!!r),t=i.useMemo(()=>n(_()),[]);return o.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)",height:"100vh"},children:[t.map(({key:a,size:r,color:u,top:m,left:p,opacity:s,animrand:c,dir:d})=>o.jsx("div",{className:"oneshot-square",style:{backgroundColor:u,opacity:s,width:r,height:r,position:"absolute",top:m,left:p,"--animrand":c*100+"ms","--dir":d}},a)),o.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),o.jsx("div",{className:"pageBackground",style:{opacity:e?1:0,backgroundColor:"black",zIndex:2},children:o.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})}),o.jsx("div",{id:"jackenstein-jackolantern"})]})},S=(e=1)=>Math.round(Math.random()*e),ye=e=>e[S(e.length-1)],xe="/assets/rain-XCcjA8b9.ogg",we=["#0000FF","#0055EE","#0a205a","#0515a6"],ke=()=>{const e=i.useCallback(a=>{let r=new Set,u=g(),m=.4;const p=.002;return{update(s){for(let d of r)d.y+d.size*3>=a.canvas.height?(d.y=a.canvas.height,d.splash>1?r.delete(d):d.splash+=p*d.vy*s):(d.vy+=d.sinkSpeed*.03*s,d.x+=u.x*s,d.y+=d.vy*s+u.y*s);let c=Math.floor(m*a.canvas.width);for(;r.size<c;)r.add({x:S(a.canvas.width),y:-S(a.canvas.height*2),vy:0+Math.random(),color:ye(we),sinkSpeed:S(15)+15,size:S(2)+3,splash:0,alpha:Math.random()+.1})},draw(){for(let s of r)if(a.fillStyle=s.color,a.globalAlpha=s.alpha,s.splash){const c=s.size*2,d=s.size*2,A=-1,k=(h=>f=>A*Math.pow(f-h.x,2)+h.y)(g(1,1))(s.splash*2)*d,C=s.size/2*(1.5-s.splash),l=s.size/2;a.fillRect(s.x+s.splash*c,s.y-k-l,C,C),a.fillRect(s.x-s.splash*c,s.y-k-l,C,C)}else a.fillRect(s.x,s.y,s.size/2,s.size*2+s.vy*.1)}}},[]),{ref:n}=D(e,{}),t=O();return o.jsxs("div",{className:"fullscreen",children:[o.jsx("canvas",{className:"fullscreen",ref:n}),o.jsx("audio",{src:xe,ref:t,loop:!0,autoPlay:!0})]})},Ce=()=>{const e=i.useCallback(t=>{t.lineWidth=1,t.imageSmoothingEnabled=!1;const a="#5A0D36",r="#6E1244",u="#290427",m="#4B092E",p="#2A0428",s="#B1184B",c="#1E021F",d="#FF59BE",A=(l,h,f,y)=>{t.fillStyle=f,t.fillRect(l.x,l.y,h.x,h.y),y&&(t.strokeStyle=y,t.strokeRect(l.x+.5,l.y+.5,h.x,h.y))},x=(l,h,f,y,w,I)=>{for(let R=0;R<f.x;R++)for(let E=0;E<f.y;E++)A(v(l,z(v(h,y),g(R,E))),h,w,I)},b=(l,h,f)=>{t.save(),t.globalAlpha=.5;let y=t.createRadialGradient(l.x,l.y,0,l.x,l.y,f);y.addColorStop(0,h+"ff"),y.addColorStop(1,h+"00"),t.beginPath(),t.fillStyle=y,t.arc(l.x,l.y,f,0,Math.PI*2,!1),t.fill(),t.restore()},k=({pos:l,padding:h,windowSize:f,windowSpacing:y,windowAmount:w,color:I,outlineColor:R,windowColor:E,windowUnderlineColor:M,windowLitIndicies:N,windowLitColor:P,windowLitSize:U})=>{const T=g(h.x+f.x*w.x+y.x*(w.x-1)+h.x,t.canvas.height-l.y-1);if(A(l,T,I,R),x(v(l,h),f,w,y,E),M&&x(v(l,h,g(0,f.y)),g(f.x,1),w,g(y.x,y.y+f.y-1),M),P&&N?.length&&U)for(let G of N){let L=z(g(G%w.x,Math.floor(G/w.y)),v(f,y)),J=v(l,h,L,V(f,2));b(J,d,15),A(v(l,h,L),f,P)}return{buildingSize:T}},C=({x:l,y:h,hl:f,frontWindowAmount:y,sideWindowAmount:w})=>{const E=Math.floor(t.canvas.height/14)-5,{buildingSize:M}=k({pos:g(l,h),padding:g(4,12),color:a,outlineColor:r,windowColor:p,windowSize:g(8,9),windowSpacing:g(5,5),windowAmount:g(y,E),windowUnderlineColor:s,windowLitColor:d,windowLitSize:15,windowLitIndicies:f});return k({pos:g(M.x+l+1,h),padding:g(4,12),color:u,outlineColor:m,windowColor:c,windowSize:g(4,9),windowSpacing:g(3,5),windowAmount:g(w,E)}),{frontSize:M}};return{draw(){t.lineJoin="miter",t.lineCap="square",t.strokeStyle="blue";let l=_(),h=4;for(let f of Array(20).fill(0)){let y=[...new Set(Array(5).fill(0).map(()=>Math.floor(l()*1e3)))],{frontSize:w}=C({x:h,y:t.canvas.height-Math.floor(t.canvas.height*l()*.7),frontWindowAmount:5,sideWindowAmount:3,hl:y});h+=w.x,h+=l()>.9?50:0,h+=4}}}},[]),{ref:n}=D(e,{delay:500,size:t=>{const r=480/t.clientHeight*t.clientWidth;return g(r,480)}});return o.jsx("div",{className:"pageBackground",children:o.jsx("canvas",{className:"pageBackground",style:{imageRendering:"crisp-edges",backgroundImage:"linear-gradient(#18031A, #23051F, #3B0929)"},ref:n})})},W=g(320,180),be=i.memo(()=>{const[e,n]=i.useState(!1);return i.useEffect(()=>{const t=requestAnimationFrame(()=>n(!0));return()=>cancelAnimationFrame(t)},[]),o.jsx("div",{className:"pageBackground",style:{backgroundImage:"url('/assets/img/detail/sky.png')",backgroundRepeat:"repeat",backgroundAttachment:"fixed"},children:e&&o.jsx(Ee,{})})}),Ee=()=>{const e=i.useRef(null),n=i.useRef(null);return i.useRef(null),i.useEffect(()=>{let t=new AbortController,a=t.signal;const r=requestAnimationFrame(()=>{if(a.aborted)return;const u=e.current;if(!u)return;u.width=u.clientWidth,u.height=u.clientHeight;const m=u.transferControlToOffscreen(),p=new Worker(new URL("/assets/effects.worker-DQ-p0nJE.js",import.meta.url),{type:"module"});p.postMessage({type:"init",data:m},[m]),n.current=p,window.addEventListener("scroll",()=>{p.postMessage({type:"scroll",data:g(0,window.scrollY)})},{signal:a})});return()=>{cancelAnimationFrame(r),n.current?.terminate(),t.abort(),n.current=null}},[]),B("resize",()=>{const t=e.current;t&&n.current?.postMessage({type:"dimensionsChange",data:g(t.clientWidth,t.clientHeight)})}),o.jsx("canvas",{ref:e,className:"fullscreenDynamic",style:{objectFit:"contain",aspectRatio:W.x/W.y,imageRendering:"pixelated"}})},ve=()=>{const[{type:e}]=q(),[{rain:n}]=K();return o.jsxs("div",{style:{position:"fixed",zIndex:-1},children:[n&&o.jsx(ke,{}),e==="starfield"&&o.jsx(be,{}),e==="oneshot"&&o.jsx(pe,{}),e==="depth"&&o.jsx(Ae,{}),e==="man"&&o.jsx(me,{}),e==="refuge"&&o.jsx(Ce,{})]})},Re=i.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),Me=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],je=({children:e})=>{const n=i.useRef(null),t=i.useRef(null),a=i.useRef(null),[r,u]=i.useState(null),[m,p]=i.useState(!1),[s,c]=i.useState(!1);i.useEffect(()=>{let A=new Audio;return n.current=A,()=>{t.current?.close(),A.pause(),A.remove(),n.current=null}},[]),i.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:x}=A;return n.current.addEventListener("playing",()=>{j.hide("music-error")},{signal:x}),()=>A.abort()},[]),i.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:x}=A;return n.current.addEventListener("ended",()=>{if(!r)return;const b=Me;let k=b.indexOf(r);if(k==-1)return;let C=k+1;C>=b.length&&(C=0);let l=b[C];l&&u(l)},{signal:x}),()=>A.abort()},[r]),i.useEffect(()=>{if(r)return j.show({id:"music-nowplaying",title:o.jsx(F,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:r.title}),()=>void j.hide("music-nowplaying");j.hide("music-nowplaying")},[r]);const d=()=>{n.current?.play().then(()=>{t.current=new AudioContext;let A=t.current.createMediaElementSource(n.current);a.current=t.current.createAnalyser(),A.connect(a.current),A.connect(t.current.destination)}).catch(A=>{if(A instanceof DOMException&&A.name=="NotAllowedError"){j.show({id:"music-error",message:o.jsx(F,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const x=()=>d();window.addEventListener("click",x,{once:!0})}})};return i.useEffect(()=>{n.current&&(n.current.pause(),n.current.src=r?`/assets/music/${r.file}`:"",r&&d())},[r]),o.jsx(Re.Provider,{value:{ref:n,loading:m,playing:s,currentSong:r,analyser:a,audioContext:t,changeCurrentSong:u},children:e})},Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",Ie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAAAAAAAAPlDu38AAAAHdElNRQfpCAoOASJktxbgAAAA6UlEQVQ4y9WTIQ7CQBBFXwmqWGpBo6u5CdwBzQHQWDTcBF2NBguWWjAz4bMM7Ur4yaZN+/flZaeFX0/hN4/XszUwAu7ARks5nRS4AuZSPgLbRCLsOGgoxQUwA2optwbYCqxOOjfbe0iBEwNWQGmrTuwcpp0ZcPaCAqdSwq6VAXYCrJJOaXs/gFEUSgILkwMsgTGZGeQWc6OGZzkPPctvaW2dkKGo4cVeXq3Yl9a6J9sLxH/KntcgIlM3awy4VFA0lMaAE+KpupkD31KkDzpMHRaaRUPpM6XL7Kthh6kDl10b+z5sNXXgn+cJ6No9ST9X3LMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMDgtMTBUMTQ6MDE6MzQrMDA6MDABpoTaAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTA4LTEwVDE0OjAxOjM0KzAwOjAwcPs8ZgAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0wOC0xMFQxNDowMTozNCswMDowMCfuHbkAAAAASUVORK5CYII=",Be=()=>{const{ref:e}=i.useContext($);return o.jsxs("div",{id:"SOUL",ref:e,children:[o.jsx("div",{className:"soul heart",style:{backgroundImage:`url("${Se}")`}}),o.jsx("div",{className:"soul blur",style:{backgroundImage:`url("${Ie}")`}})]})},De=({providers:e,children:n})=>o.jsx(o.Fragment,{children:e.reduceRight((t,a)=>o.jsx(a,{children:t}),n)}),We=X(function(){return o.jsxs(De,{providers:[ee,te,ne,re,ae,je,se],children:[o.jsx(ve,{}),o.jsx(Be,{}),o.jsx(Z,{})]})}),He=Y(function(){return o.jsx(le,{my:"xl",h:"90vh",children:o.jsx(oe,{})})});export{He as HydrateFallback,We as default};
