import{r as i,w as y,O as w}from"./chunk-QMGIS6GS-CucUpDno.js";import{j as t}from"./jsx-runtime-BjG_zV1W.js";import{u as v,L as x,M as j,F as b,U as C}from"./MusicPlayerContext-YDoh4Pee.js";import"./LanguageContext-DpyevvSK.js";import{a as u}from"./notifications.store-Bz_BhetN.js";import"./random-id-CQPYUG5g.js";const M=()=>{const{myBurdenIsDead:m}=v(),r=i.useMemo(()=>[1,-1].map(n=>Array(128).fill(0).map((s,e)=>{const l=Math.floor(Math.random()*4)*5;return{key:n*(e+1),color:n>0?"#97257a":"#7463aa",size:l,top:Math.random()/2*100+(n==1?80:0)-20+"%",left:Math.random()*100+"%"}})).flat(),[]);return t.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)"},children:[r.map(({key:n,size:s,color:e,top:l,left:d})=>t.jsx("div",{style:{backgroundColor:e,opacity:.7,width:s,height:s,position:"absolute",top:l,left:d}},n)),t.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"-60px",maxHeight:"200px",marginLeft:"1rem"}}),t.jsx("div",{className:"pageBackground",style:{opacity:m?1:0,backgroundColor:"black",zIndex:2},children:t.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",marginLeft:"1rem"}})})]})},T=()=>t.jsx("div",{children:t.jsx(M,{})}),A=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],E=({children:m})=>{const r=i.useRef(null),n=i.useRef(null),s=i.useRef(null),[e,l]=i.useState(null),[d,S]=i.useState(!1),[k,P]=i.useState(!1);i.useEffect(()=>{let o=new Audio;return r.current=o,()=>{var a;(a=n.current)==null||a.close(),o.pause(),o.remove(),r.current=null}},[]),i.useEffect(()=>{if(!r.current)return;const o=new AbortController,{signal:a}=o;return r.current.addEventListener("playing",()=>{u.hide("music-error")},{signal:a}),()=>o.abort()},[]),i.useEffect(()=>{if(!r.current)return;const o=new AbortController,{signal:a}=o;return r.current.addEventListener("ended",()=>{if(!e)return;const c=A;let p=c.indexOf(e);if(p==-1)return;let f=p+1;f>=c.length&&(f=0);let h=c[f];h&&l(h)},{signal:a}),()=>o.abort()},[e]),i.useEffect(()=>{if(e)return u.show({id:"music-nowplaying",title:t.jsx(x,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:e.title}),()=>void u.hide("music-nowplaying");u.hide("music-nowplaying")},[e]);const g=()=>{var o;(o=r.current)==null||o.play().then(()=>{n.current=new AudioContext;let a=n.current.createMediaElementSource(r.current);s.current=n.current.createAnalyser(),a.connect(s.current),a.connect(n.current.destination)}).catch(a=>{if(a instanceof DOMException&&a.name=="NotAllowedError"){u.show({id:"music-error",message:t.jsx(x,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const c=()=>g();window.addEventListener("click",c,{once:!0})}})};return i.useEffect(()=>{r.current&&(r.current.pause(),r.current.src=e?`/assets/music/${e.file}`:"",e&&g())},[e]),t.jsx(j.Provider,{value:{ref:r,loading:d,playing:k,currentSong:e,analyser:s,audioContext:n,changeCurrentSong:l},children:m})},F=y(function(){return t.jsx(b,{children:t.jsx(C,{children:t.jsxs(E,{children:[t.jsx(T,{}),t.jsx(w,{})]})})})});export{F as default};
