import{a as o,w as F,O as U}from"./chunk-ZYFC6VSF-BZmslxjh.js";import{j as s}from"./jsx-runtime-D_zvdyIk.js";import{u as I,v as w,a as _,b as H,L as S,S as z,B as J,W as X,F as Y,A as Z,U as Q,c as V}from"./AppContext-C0PdEbQM.js";import{a as R}from"./LanguageContext-Dp3_LK6K.js";import{a as b}from"./notifications.store-Bsq0dQV7.js";const K="/assets/IMAGE_DEPTH_4-O8gd5XC3.png",q="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",$=(e,n)=>{const t=o.useRef(e);t.current=e,o.useEffect(()=>{let i=performance.now();const r=()=>{performance.now()-i>=n&&(t.current(),i=performance.now()),u=requestAnimationFrame(r)};let u=requestAnimationFrame(r);return()=>{cancelAnimationFrame(u)}},[])},B=(e,n={})=>{const t=o.useRef(null),i=o.useRef(null),r=o.useRef(null);o.useEffect(()=>{const a=t.current;if(!a)return;a.width=n.size?.x||a.clientWidth,a.height=n.size?.y||a.clientHeight;const l=a.getContext("2d",{alpha:!0,desynchronized:!0});return l?(i.current=l,r.current=e(l),()=>{r.current?.destroy?.(),i.current=null}):n?.onFail?.()},[e,t]);const u=o.useCallback(()=>{r.current?.update?.(1),i.current&&i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height),r.current?.draw()},[n.noClear]);$(u,30);const f=o.useCallback(()=>{t.current&&(t.current.width=n.size?.x||t.current.clientWidth,t.current.height=n.size?.y||t.current.clientHeight)},[t,n.size]);return R("resize",f),{ref:t}},D=()=>{const e=o.useRef(null),n=o.useCallback(()=>{e.current?.play().catch(()=>{})},[e]);return R("click",n,{once:!0}),e};class ee{siner;alpha;xstretch;ystretch;o_insurance;depth;b_insurance;OBSPEED;constructor(){this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}shouldDraw(){return this.siner<150&&this.siner>2}getAlpha(){return Math.max(0,.2+this.alpha-this.o_insurance+this.b_insurance)}}const te=()=>{I("ARE WE CONNECTED?");const e=o.useCallback(i=>{let r=[],u=new Image;u.src=K;let f=0,a=0,l=.5;return{update(){if(f+=1,a+=l,a>=20){let d=new ee;d.depth=5+f,d.OBSPEED=.01*l,d.destroy=()=>r=r.filter(g=>g!==d),r.unshift(d),f>=6e4&&(f=0),a=0}for(let d of r)d.step()},draw(){if(u.complete)for(let d of r){if(!d.shouldDraw())continue;let g=d.getAlpha();i.globalAlpha=g;const c=u.width*d.xstretch,A=u.height*d.ystretch;i.drawImage(u,160-c/2,120-A/2,c,A)}}}},[]),{ref:n}=B(e,{size:w(320,240)}),t=D();return s.jsxs("div",{className:"pageBackground",children:[s.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"crisp-edges"},ref:n}),s.jsx("audio",{src:q,ref:t,autoPlay:!0,loop:!0})]})},ne="/assets/tree-DOnJeJ13.gif",re="/assets/man-DVTDGMKe.ogg",se=()=>{const e=D();return I("* "),s.jsxs("div",{className:"pageBackground",children:[s.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${ne}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),s.jsx("audio",{src:re,loop:!0,autoPlay:!0,ref:e})]})},ae=()=>{const{myBurdenIsDead:e}=_(),[n]=o.useState(()=>[1,-1].map(t=>Array(128).fill(0).map((i,r)=>{const u=Math.floor(Math.random()*4)*5;return{key:t*(r+1),color:t>0?"#97257a":"#7463aa",size:u,top:Math.random()/2*100+(t==1?80:0)-20+"%",left:Math.random()*100+"%"}})).flat());return s.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)",height:"100vh"},children:[n.map(({key:t,size:i,color:r,top:u,left:f})=>s.jsx("div",{style:{backgroundColor:r,opacity:.7,width:i,height:i,position:"absolute",top:u,left:f}},t)),s.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),s.jsx("div",{className:"pageBackground",style:{opacity:e?1:0,backgroundColor:"black",zIndex:2},children:s.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})})]})},oe=()=>{let e=49734321;return()=>(e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,(e&268435455)/268435456)},ie=()=>{const e=o.useCallback(t=>{t.lineWidth=1,t.imageSmoothingEnabled=!1;const i=(a,l,d,g,c,A)=>{t.fillStyle=c,t.fillRect(a,l,d,g),A&&(t.strokeStyle=A,t.strokeRect(a+.5,l+.5,d,g))},r=(a,l,d,g,c,A,h,p,m,k)=>{for(let C=0;C<c;C++)for(let x=0;x<A;x++)i(a+(d+h)*C,l+(g+p)*x,d,g,m,k)},u=(a,l,d,g)=>{t.save(),t.globalAlpha=.5;let c=t.createRadialGradient(a,l,0,a,l,g);c.addColorStop(0,d+"ff"),c.addColorStop(1,d+"00"),t.beginPath(),t.fillStyle=c,t.arc(a,l,g,0,Math.PI*2,!1),t.fill(),t.restore()},f=({x:a,y:l,fw:d,h:g,sw:c,wh:A,ww:h,wax:p,way:m,hl:k})=>{const C="#5A0D36",x="#6E1244",O="#290427",N="#4B092E",G="#2A0428",T="#B1184B",P="#1E021F",M="#FF59BE";i(a+d-1,l,c,g,O,N),i(a,l,d,g,C,x),r(a+4,l+12,h,A,p,m,5,5,G),r(a+4,l+12+A,h,1,p,m,5,5+A-1,T),r(a+d+3,l+12,4,A,3,m,3,5,P);for(let E of k){let y=E%p*(h+5),v=Math.floor(E/m)*(A+5),L=a+4+y+h/2,W=l+12+v+A/2;u(L,W,M,15)}for(let E of k){let y=E%p*(h+5),v=Math.floor(E/m)*(A+5);i(a+4+y,l+12+v,h,A,M)}};return{draw(){t.lineJoin="miter",t.lineCap="square",t.strokeStyle="blue";let a=oe(),l=[...new Set(Array(5).fill(0).map(()=>Math.floor(a()*25)))];f({x:50,y:50,fw:70,sw:25,h:200,ww:8,wh:9,wax:5,way:5,hl:l})}}},[]),{ref:n}=B(e);return s.jsx("div",{className:"pageBackground",children:s.jsx("canvas",{className:"pageBackground",style:{imageRendering:"crisp-edges"},ref:n})})},j=w(320,180),ce=o.memo(()=>{const[e,n]=o.useState(!1);return o.useEffect(()=>{const t=requestAnimationFrame(()=>n(!0));return()=>cancelAnimationFrame(t)},[]),s.jsx("div",{className:"pageBackground",style:{backgroundImage:"url('/assets/img/detail/sky.png')",backgroundRepeat:"repeat",backgroundAttachment:"fixed"},children:e&&s.jsx(le,{})})}),le=()=>{const e=o.useRef(null),n=o.useRef(null);return o.useRef(null),o.useEffect(()=>{let t=new AbortController,i=t.signal;const r=requestAnimationFrame(()=>{if(i.aborted)return;const u=e.current;if(!u)return;u.width=u.clientWidth,u.height=u.clientHeight;const f=u.transferControlToOffscreen(),a=new Worker(new URL("/assets/effects.worker-DQ-p0nJE.js",import.meta.url),{type:"module"});a.postMessage({type:"init",data:f},[f]),n.current=a,window.addEventListener("scroll",()=>{a.postMessage({type:"scroll",data:w(0,window.scrollY)})},{signal:i})});return()=>{cancelAnimationFrame(r),n.current?.terminate(),t.abort(),n.current=null}},[]),R("resize",()=>{const t=e.current;t&&n.current?.postMessage({type:"dimensionsChange",data:w(t.clientWidth,t.clientHeight)})}),s.jsx("canvas",{ref:e,className:"fullscreenDynamic",style:{objectFit:"contain",aspectRatio:j.x/j.y,imageRendering:"pixelated"}})},ue=()=>{const[{type:e}]=H();return s.jsxs("div",{style:{position:"fixed",zIndex:-1},children:[e==="starfield"&&s.jsx(ce,{}),e==="oneshot"&&s.jsx(ae,{}),e==="depth"&&s.jsx(te,{}),e==="man"&&s.jsx(se,{}),e==="refuge"&&s.jsx(ie,{})]})},de=o.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),Ae=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],ge=({children:e})=>{const n=o.useRef(null),t=o.useRef(null),i=o.useRef(null),[r,u]=o.useState(null),[f,a]=o.useState(!1),[l,d]=o.useState(!1);o.useEffect(()=>{let c=new Audio;return n.current=c,()=>{t.current?.close(),c.pause(),c.remove(),n.current=null}},[]),o.useEffect(()=>{if(!n.current)return;const c=new AbortController,{signal:A}=c;return n.current.addEventListener("playing",()=>{b.hide("music-error")},{signal:A}),()=>c.abort()},[]),o.useEffect(()=>{if(!n.current)return;const c=new AbortController,{signal:A}=c;return n.current.addEventListener("ended",()=>{if(!r)return;const h=Ae;let p=h.indexOf(r);if(p==-1)return;let m=p+1;m>=h.length&&(m=0);let k=h[m];k&&u(k)},{signal:A}),()=>c.abort()},[r]),o.useEffect(()=>{if(r)return b.show({id:"music-nowplaying",title:s.jsx(S,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:r.title}),()=>void b.hide("music-nowplaying");b.hide("music-nowplaying")},[r]);const g=()=>{n.current?.play().then(()=>{t.current=new AudioContext;let c=t.current.createMediaElementSource(n.current);i.current=t.current.createAnalyser(),c.connect(i.current),c.connect(t.current.destination)}).catch(c=>{if(c instanceof DOMException&&c.name=="NotAllowedError"){b.show({id:"music-error",message:s.jsx(S,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const A=()=>g();window.addEventListener("click",A,{once:!0})}})};return o.useEffect(()=>{n.current&&(n.current.pause(),n.current.src=r?`/assets/music/${r.file}`:"",r&&g())},[r]),s.jsx(de.Provider,{value:{ref:n,loading:f,playing:l,currentSong:r,analyser:i,audioContext:t,changeCurrentSong:u},children:e})},fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAAAAAAAAPlDu38AAAAHdElNRQfpCAoOASJktxbgAAAA6UlEQVQ4y9WTIQ7CQBBFXwmqWGpBo6u5CdwBzQHQWDTcBF2NBguWWjAz4bMM7Ur4yaZN+/flZaeFX0/hN4/XszUwAu7ARks5nRS4AuZSPgLbRCLsOGgoxQUwA2optwbYCqxOOjfbe0iBEwNWQGmrTuwcpp0ZcPaCAqdSwq6VAXYCrJJOaXs/gFEUSgILkwMsgTGZGeQWc6OGZzkPPctvaW2dkKGo4cVeXq3Yl9a6J9sLxH/KntcgIlM3awy4VFA0lMaAE+KpupkD31KkDzpMHRaaRUPpM6XL7Kthh6kDl10b+z5sNXXgn+cJ6No9ST9X3LMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMDgtMTBUMTQ6MDE6MzQrMDA6MDABpoTaAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTA4LTEwVDE0OjAxOjM0KzAwOjAwcPs8ZgAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0wOC0xMFQxNDowMTozNCswMDowMCfuHbkAAAAASUVORK5CYII=",me=()=>{const{ref:e}=o.useContext(z);return s.jsxs("div",{id:"SOUL",ref:e,children:[s.jsx("div",{className:"soul heart",style:{backgroundImage:`url("${fe}")`}}),s.jsx("div",{className:"soul blur",style:{backgroundImage:`url("${he}")`}})]})},pe=({providers:e,children:n})=>s.jsx(s.Fragment,{children:e.reduceRight((t,i)=>s.jsx(i,{children:t}),n)}),we=F(function(){return s.jsxs(pe,{providers:[J,X,Y,Z,Q,ge,V],children:[s.jsx(ue,{}),s.jsx(me,{}),s.jsx(U,{})]})});export{we as default};
