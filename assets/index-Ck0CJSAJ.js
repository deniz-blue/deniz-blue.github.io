import{a as b,w as pe}from"./chunk-C37GKA54-C1SU4sNO.js";import{j as i}from"./jsx-runtime-D_zvdyIk.js";import{a as me,u as he,d as ge,S as ye,e as te,b as re,f as ve}from"./AppContext-CUrJxGGg.js";import{i as M,h as A,j as P,l as $,B as I,r as xe,n as U,w as be,q as L,m as oe,s as N,y as se,I as ne,u as je,k,z as Se}from"./polymorphic-factory-BvxDOETY.js";import{S as D,T as ie}from"./Stack-BM5NGK3T.js";import{p as G,U as we,T as V,L as _e,O as Be,g as Ie,P as le}from"./Loader-DG7EUfAj.js";import{a as Z}from"./use-window-event-UTFVsWTy.js";import"./index-Dz_XntDv.js";function Ne(e,r){return e in r?G(r[e]):G(e)}function Ee(e,r){const t=e.map(o=>({value:o,px:Ne(o,r)}));return t.sort((o,s)=>o.px-s.px),t}function C(e){return typeof e=="object"&&e!==null?"base"in e?e.base:void 0:e}function Ae(e=[]){const[r,t]=b.useState(e);return[r,{setState:t,append:(...c)=>t(p=>[...p,...c]),prepend:(...c)=>t(p=>[...c,...p]),insert:(c,...p)=>t(g=>[...g.slice(0,c),...p,...g.slice(c)]),pop:()=>t(c=>{const p=[...c];return p.pop(),p}),shift:()=>t(c=>{const p=[...c];return p.shift(),p}),apply:c=>t(p=>p.map((g,m)=>c(g,m))),applyWhere:(c,p)=>t(g=>g.map((m,S)=>c(m,S)?p(m,S):m)),remove:(...c)=>t(p=>p.filter((g,m)=>!c.includes(m))),reorder:({from:c,to:p})=>t(g=>{const m=[...g],S=g[c];return m.splice(c,1),m.splice(p,0,S),m}),swap:({from:c,to:p})=>t(g=>{const m=[...g],S=m[c],d=m[p];return m.splice(p,1,S),m.splice(c,1,d),m}),setItem:(c,p)=>t(g=>{const m=[...g];return m[c]=p,m}),setItemProp:(c,p,g)=>t(m=>{const S=[...m];return S[c]={...S[c],[p]:g},S}),filter:c=>{t(p=>p.filter(c))}}]}var T={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const J={orientation:"horizontal"},Ce=$((e,{borderWidth:r})=>({group:{"--ai-border-width":xe(r)}})),q=M((e,r)=>{const t=A("ActionIconGroup",J,e),{className:o,style:s,classNames:n,styles:l,unstyled:u,orientation:h,vars:f,borderWidth:a,variant:y,mod:E,attributes:x,...j}=A("ActionIconGroup",J,e),w=P({name:"ActionIconGroup",props:t,classes:T,className:o,style:s,classNames:n,styles:l,unstyled:u,attributes:x,vars:f,varsResolver:Ce,rootSelector:"group"});return i.jsx(I,{...w("group"),ref:r,variant:y,mod:[{"data-orientation":h},E],role:"group",...j})});q.classes=T;q.displayName="@mantine/core/ActionIconGroup";const Pe=$((e,{radius:r,color:t,gradient:o,variant:s,autoContrast:n,size:l})=>{const u=e.variantColorResolver({color:t||e.primaryColor,theme:e,gradient:o,variant:s||"filled",autoContrast:n});return{groupSection:{"--section-height":L(l,"section-height"),"--section-padding-x":L(l,"section-padding-x"),"--section-fz":be(l),"--section-radius":r===void 0?void 0:U(r),"--section-bg":t||s?u.background:void 0,"--section-color":u.color,"--section-bd":t||s?u.border:void 0}}}),H=M((e,r)=>{const t=A("ActionIconGroupSection",null,e),{className:o,style:s,classNames:n,styles:l,unstyled:u,vars:h,variant:f,gradient:a,radius:y,autoContrast:E,attributes:x,...j}=t,w=P({name:"ActionIconGroupSection",props:t,classes:T,className:o,style:s,classNames:n,styles:l,unstyled:u,attributes:x,vars:h,varsResolver:Pe,rootSelector:"groupSection"});return i.jsx(I,{...w("groupSection"),ref:r,variant:f,...j})});H.classes=T;H.displayName="@mantine/core/ActionIconGroupSection";const Te=$((e,{size:r,radius:t,variant:o,gradient:s,color:n,autoContrast:l})=>{const u=e.variantColorResolver({color:n||e.primaryColor,theme:e,gradient:s,variant:o||"filled",autoContrast:l});return{root:{"--ai-size":L(r,"ai-size"),"--ai-radius":t===void 0?void 0:U(t),"--ai-bg":n||o?u.background:void 0,"--ai-hover":n||o?u.hover:void 0,"--ai-hover-color":n||o?u.hoverColor:void 0,"--ai-color":u.color,"--ai-bd":n||o?u.border:void 0}}}),z=oe((e,r)=>{const t=A("ActionIcon",null,e),{className:o,unstyled:s,variant:n,classNames:l,styles:u,style:h,loading:f,loaderProps:a,size:y,color:E,radius:x,__staticSelector:j,gradient:w,vars:c,children:p,disabled:g,"data-disabled":m,autoContrast:S,mod:d,attributes:v,..._}=t,B=P({name:["ActionIcon",j],props:t,className:o,style:h,classes:T,classNames:l,styles:u,unstyled:s,attributes:v,vars:c,varsResolver:Te});return i.jsxs(we,{...B("root",{active:!g&&!f&&!m}),..._,unstyled:s,variant:n,size:y,disabled:g||f,ref:r,mod:[{loading:f,disabled:g||m},d],children:[i.jsx(V,{mounted:!!f,transition:"slide-down",duration:150,children:F=>i.jsx(I,{component:"span",...B("loader",{style:F}),"aria-hidden":!0,children:i.jsx(_e,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...a})})}),i.jsx(I,{component:"span",mod:{loading:f},...B("icon"),children:p})]})});z.classes=T;z.displayName="@mantine/core/ActionIcon";z.Group=q;z.GroupSection=H;var ae={root:"m_7f854edf"};const Re={position:{bottom:0,right:0},zIndex:Ie("modal"),withinPortal:!0},$e=$((e,{zIndex:r,position:t})=>({root:{"--affix-z-index":r?.toString(),"--affix-top":N(t?.top),"--affix-left":N(t?.left),"--affix-bottom":N(t?.bottom),"--affix-right":N(t?.right)}})),K=M((e,r)=>{const t=A("Affix",Re,e),{classNames:o,className:s,style:n,styles:l,unstyled:u,vars:h,portalProps:f,zIndex:a,withinPortal:y,position:E,attributes:x,...j}=t,w=P({name:"Affix",classes:ae,props:t,className:s,style:n,classNames:o,styles:l,unstyled:u,attributes:x,vars:h,varsResolver:$e});return i.jsx(Be,{...f,withinPortal:y,children:i.jsx(I,{ref:r,...w("root"),...j})})});K.classes=ae;K.displayName="@mantine/core/Affix";var ce={root:"m_9e117634"};const ze=$((e,{radius:r,fit:t})=>({root:{"--image-radius":r===void 0?void 0:U(r),"--image-object-fit":t}})),O=oe((e,r)=>{const t=A("Image",null,e),{classNames:o,className:s,style:n,styles:l,unstyled:u,vars:h,onError:f,src:a,radius:y,fit:E,fallbackSrc:x,mod:j,attributes:w,...c}=t,[p,g]=b.useState(!a);b.useEffect(()=>g(!a),[a]);const m=P({name:"Image",classes:ce,props:t,className:s,style:n,classNames:o,styles:l,unstyled:u,attributes:w,vars:h,varsResolver:ze});return p&&x?i.jsx(I,{component:"img",ref:r,src:x,...m("root"),onError:f,mod:["fallback",j],...c}):i.jsx(I,{component:"img",ref:r,...m("root"),src:a,onError:S=>{f?.(S),g(!0)},mod:j,...c})});O.classes=ce;O.displayName="@mantine/core/Image";function ke({spacing:e,verticalSpacing:r,cols:t,selector:o}){const s=je(),n=r===void 0?e:r,l=se({"--sg-spacing-x":N(C(e)),"--sg-spacing-y":N(C(n)),"--sg-cols":C(t)?.toString()}),u=k(s.breakpoints).reduce((a,y)=>(a[y]||(a[y]={}),typeof e=="object"&&e[y]!==void 0&&(a[y]["--sg-spacing-x"]=N(e[y])),typeof n=="object"&&n[y]!==void 0&&(a[y]["--sg-spacing-y"]=N(n[y])),typeof t=="object"&&t[y]!==void 0&&(a[y]["--sg-cols"]=t[y]),a),{}),f=Ee(k(u),s.breakpoints).filter(a=>k(u[a.value]).length>0).map(a=>({query:`(min-width: ${s.breakpoints[a.value]})`,styles:u[a.value]}));return i.jsx(ne,{styles:l,media:f,selector:o})}function W(e){return typeof e=="object"&&e!==null?k(e):[]}function De(e){return e.sort((r,t)=>G(r)-G(t))}function Ge({spacing:e,verticalSpacing:r,cols:t}){const o=Array.from(new Set([...W(e),...W(r),...W(t)]));return De(o)}function Oe({spacing:e,verticalSpacing:r,cols:t,selector:o}){const s=r===void 0?e:r,n=se({"--sg-spacing-x":N(C(e)),"--sg-spacing-y":N(C(s)),"--sg-cols":C(t)?.toString()}),l=Ge({spacing:e,verticalSpacing:r,cols:t}),u=l.reduce((f,a)=>(f[a]||(f[a]={}),typeof e=="object"&&e[a]!==void 0&&(f[a]["--sg-spacing-x"]=N(e[a])),typeof s=="object"&&s[a]!==void 0&&(f[a]["--sg-spacing-y"]=N(s[a])),typeof t=="object"&&t[a]!==void 0&&(f[a]["--sg-cols"]=t[a]),f),{}),h=l.map(f=>({query:`simple-grid (min-width: ${f})`,styles:u[f]}));return i.jsx(ne,{styles:n,container:h,selector:o})}var ue={container:"m_925c2d2c",root:"m_2415a157"};const Me={cols:1,spacing:"md",type:"media"},Y=M((e,r)=>{const t=A("SimpleGrid",Me,e),{classNames:o,className:s,style:n,styles:l,unstyled:u,vars:h,cols:f,verticalSpacing:a,spacing:y,type:E,attributes:x,...j}=t,w=P({name:"SimpleGrid",classes:ue,props:t,className:s,style:n,classNames:o,styles:l,unstyled:u,attributes:x,vars:h}),c=Se();return E==="container"?i.jsxs(i.Fragment,{children:[i.jsx(Oe,{...t,selector:`.${c}`}),i.jsx("div",{...w("container"),children:i.jsx(I,{ref:r,...w("root",{className:c}),...j})})]}):i.jsxs(i.Fragment,{children:[i.jsx(ke,{...t,selector:`.${c}`}),i.jsx(I,{ref:r,...w("root",{className:c}),...j})]})});Y.classes=ue;Y.displayName="@mantine/core/SimpleGrid";const Fe=()=>{const{disable:e,myBurdenIsDead:r,enable:t,toggle:o}=me();return he(r?"[You killed Niko]":"deniz.blue ðŸ’¡"),ge([["r",()=>e("myBurdenIsDead")]]),i.jsx(I,{children:i.jsxs(D,{w:"100%",align:"center",justify:"center",h:"100dvh",gap:4,children:[i.jsx(le,{className:"frost",p:4,children:i.jsxs(ie,{fz:"xs",c:r?"dimmed":"white",children:["My Burden is ",r?"Dead":"Light"]})}),i.jsx(V,{mounted:r,keepMounted:!0,children:s=>i.jsx(O,{style:{userSelect:"none",...s},draggable:!1,src:"/assets/img/detail/oneshot/SunBroken.png",title:"[You broke it.]",w:32,h:32})}),!r&&i.jsx(z,{variant:"subtle",color:"black",onClick:()=>o("myBurdenIsDead"),size:32,children:i.jsx(O,{src:"/assets/img/detail/oneshot/item_start_lightbulb.png",title:"[Be careful.]",w:32,h:32})})]})})},We=({children:e,disabled:r})=>{const t=b.useRef(null),{selectables:o,setSelected:s}=b.useContext(ye);return b.useEffect(()=>{if(r)o.delete(t);else return o.add(t),()=>void o.delete(t)},[t,r]),b.useEffect(()=>{if(!t.current)return;const n=t.current,l=new AbortController,u=l.signal;return n.addEventListener("mouseenter",()=>s(t),{signal:u}),()=>l.abort()},[t]),i.jsx("div",{ref:t,children:e})},Le=()=>i.jsx(D,{m:"xl",align:"center",children:i.jsx(Y,{cols:3,spacing:"xl",children:["DARK","DARKER","YET DARKER","SOUL","SUN","STRAWBERRY"].map((e,r)=>i.jsx(We,{children:i.jsx(le,{style:{cursor:"pointer"},children:i.jsx(ie,{ta:"center",inline:!0,span:!0,ff:"monospace",c:"white",children:e})})},r))})}),Ue=({disabled:e,inputRef:r,onKeyDown:t,setValue:o,value:s})=>{const n=b.useCallback(()=>{r.current&&!e&&document.getSelection()?.isCollapsed&&r.current!==document.activeElement&&(r.current.focus(),r.current.setSelectionRange(r.current.value.length,r.current.value.length))},[e]);return Z("mouseup",n),Z("touchend",n),b.useLayoutEffect(()=>{r.current&&(r.current.style.width=(s.length+1)*10.7+"px")},[s]),i.jsx("input",{ref:r,className:"terminal-input",onKeyDown:t,value:e?"":s,onChange:l=>{o(l.currentTarget.value)},disabled:e,autoCapitalize:"none",autoComplete:"off",spellCheck:"false",autoFocus:!0})},Ve={Black:"#000000",Blue:"#2472c8",BrightBlack:"#666666",BrightBlue:"#3b8eea",BrightCyan:"#29b8db",BrightGreen:"#23d18b",BrightMagenta:"#d670d6",BrightRed:"#f14c4c",BrightWhite:"#e5e5e5",BrightYellow:"#f5f543",Cyan:"#11a8cd",Green:"#0dbc79",Magenta:"#bc3fbc",Red:"#cd3131",White:"#e5e5e5",Yellow:"#e5e510",selection:"#264f78"},Q=e=>e&&(Ve[e]??e),qe=({buffer:e,onClick:r})=>i.jsx(I,{component:"pre",className:"terminal-content",children:e.map((t,o)=>{const s={color:Q(t.fg),backgroundColor:Q(t.bg),fontWeight:t.b?"bold":"normal"};let n;return t.filepath&&(n=()=>r?.(t)),n?i.jsx("a",{onClick:n,style:s,children:t.text},o):i.jsx("span",{style:s,children:t.text},o)})}),He=e=>typeof e=="string"?{text:e}:e;class Ke{root;constructor(r){this.root=r}normalize(r){return r.split("/").filter(Boolean).reduce((t,o)=>(o==="."||(o===".."?t.pop():t.push(o)),t),[])}resolve(r){return["",...this.normalize(r)].join("/")}getNode(r){const t=this.normalize(r);let o=this.root;for(const s of t){if(o.type!=="dir"||!o.children)return null;const n=o.children.find(l=>l.name===s);if(!n)return null;o=n}return o}exists(r){return this.getNode(r)!==null}read(r){const t=this.getNode(r);if(!t||t.type!=="file")throw new Error(`File not found: ${r}`);return t.content??""}write(r,t){const o=this.normalize(r),s=o.pop();if(!s)throw new Error("Invalid path");let n=this.getNode("/"+o.join("/"));if(!n||n.type!=="dir")throw new Error("Directory not found");const l=n.children?.find(h=>h.name===s);if(l&&l.type!=="file")throw new Error(`Cannot overwrite directory: ${s}`);n.children||(n.children=[]);const u={name:s,type:"file",content:t};l?Object.assign(l,u):n.children.push(u)}mkdir(r){const t=this.normalize(r),o=t.pop();if(!o)throw new Error("Invalid path");const s=this.getNode("/"+t.join("/"));if(!s||s.type!=="dir")throw new Error("Parent directory does not exist");if(s.children||(s.children=[]),s.children.find(n=>n.name===o))throw new Error("Directory or file already exists");s.children.push({name:o,type:"dir",children:[]})}rm(r){const t=this.normalize(r),o=t.pop();if(!o)throw new Error("Invalid path");const s=this.getNode("/"+t.join("/"));if(!s||s.type!=="dir"||!s.children)throw new Error("Parent directory not found");const n=s.children.findIndex(l=>l.name===o);if(n===-1)throw new Error("Target not found");s.children.splice(n,1)}}function Ye(e){if(!e.args[0])throw new Error("cat: Please provide arguments mrrow~");const r=e.relPathToAbsPath(e.args[0]);if(!r)throw new Error(`cat: ${e.args[0]}: No such file or directory`);const t=e.fs.getNode(r);if(t.type=="dir")throw new Error(`cat: ${e.args[0]}: Is a directory`);e.stdout(t.content||"")}const Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));function Je(e){if(!e.args[0])throw new Error("Usage: cd <path>");let r=e.fs.resolve((e.args[0][0]=="/"?"":e.cwd+"/")+e.args[0]);if(!e.fs.exists(r))throw new Error(`shell: cd: ${r}: No such file or directory`);e.cd(r)}const Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"}));function Xe(e){e.stdout(e.args.join(" "))}const et=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));function de(e){let r=e.relPathToAbsPath(e.args.join(" ")||".");if(!r)throw new Error(`ls: cannot access '${r}': No such file or directory`);let t=e.fs.getNode(r);for(let o of t?.children||[]){let s,n;o.type=="dir"&&(s="Blue",n=!0),o.execute&&(s="Green",n=!0),e.stdout({text:o.name,fg:s,b:n,filepath:e.fs.resolve(r+"/"+o.name)}),e.stdout(" ")}}const tt=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));function rt(e){de({...e,args:["/bin"]})}const ot=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),X=(e,r)=>({name:e,type:"file",content:r}),ee=(e,r)=>({name:e,type:"file",execute:r}),R=(e,r)=>({name:e,type:"dir",children:r}),st=Object.assign({"./programs/cat.ts":Ze,"./programs/cd.ts":Qe,"./programs/echo.ts":et,"./programs/help.ts":ot,"./programs/ls.ts":tt}),nt="./programs/",it=R("/",[R("home",[R("user",[ee("DEVICE",e=>{e.app.setBackground({type:"depth"}),e.app.setFlags({showTerminal:!1,showDevice:!0})}),X("NOTE.txt","this section is still a WIP"),R("stuff",[X("girl","mrrp :3")])])]),R("bin",Object.entries(st).map(([e,r])=>{let t=e.replace(nt,"").split(".")[0];return ee(t,r.default)}))]),lt=({onSubmit:e})=>{const r=b.useRef(null),[t,o]=b.useState(""),[s,n]=Ae(),l=b.useRef(null);return{inputRef:r,onKeyDown:h=>{if(h.key=="Enter")h.preventDefault(),e?.(t),s[s.length-1]!==t&&n.append(t),l.current=null,o("");else if(h.key=="ArrowUp"||h.key=="ArrowDown"){h.preventDefault();let f=l.current,a=h.key=="ArrowUp"?f==null?s.length-1:f-1:f==null?null:f+1;a!==null&&a<0&&(a=0),a!==null&&a>=s.length&&(a=null),o(a===null?"":s[a]),l.current=a}},value:t,setValue:o}},at=e=>{const r=b.useRef(null);return b.useEffect(()=>{r.current?.scrollTo({top:r.current.scrollHeight})},[r,...e]),r},ct=()=>{const[e,r]=te(),[t,o]=re(),s={setFlags:r,setBackground:o},n=b.useRef("user"),l=b.useRef("/home/user"),u=new Ke(it),h=d=>{let v=`/home/${n.current}`;return d.startsWith(v)?d.replace(v,"~"):d},f=()=>[{text:`${n.current}@lab02`,fg:"Green",b:!0},{text:":",b:!0},{text:h(l.current),fg:"Blue",b:!0,filepath:l.current},{text:"$ ",b:!0}],[a,y]=b.useState([{text:`SHARK OS v0.02
`,fg:"Cyan",b:!0},{text:`Type 'help' for a list of commands
`,fg:"BrightBlack"},{text:`Last login: ${new Date().toLocaleString("en",{dateStyle:"long",timeStyle:"medium"})} from 127.0.0.1
`,fg:"BrightBlack"},...f()]),E=at([a]),x=d=>{let v=Array.isArray(d)?d:[d];y(_=>[..._,...v.map(He)])},j=async(d,v)=>{if(!d.execute)return x({text:`shell: ${d.name}: ${d.type=="file"?"Permission denied":"Is a directory"}`});try{await d.execute({cwd:l.current,cd:_=>l.current=_,username:n.current,setUsername:_=>n.current=_,args:v,stdout:x,stdin:"",fs:u,app:s,relPathToAbsPath:c})}catch(_){x({text:""+_.message,fg:"BrightRed"})}},w=["/bin"],c=d=>d?d.startsWith("/")?u.exists(d)?d:null:[l.current+"/"+d,...w.map(v=>v+"/"+d)].find(v=>u.exists(v))??null:null,p=d=>{const v=l.current.split("/").filter(Boolean),_=d.split("/").filter(Boolean);let B=0;for(;B<v.length&&B<_.length&&v[B]===_[B];)B++;const F=v.length-B,fe=_.slice(B);return[...Array(F).fill(".."),...fe].join("/")||"."},g=d=>{const[v,..._]=d.split(" ");let B=c(v);if(!B)return x(`shell: ${d}: No such file or directory`);j(u.getNode(B),_)},S=lt({onSubmit:async d=>{x(d),x(`
`),d&&(g(d),x(`
`)),x(f())}});return i.jsxs(I,{className:"fullscreen terminal",style:{lineHeight:1,display:"inline-block"},ref:E,children:[i.jsx(qe,{buffer:a,onClick:d=>{if(d.filepath){let v=u.getNode(d.filepath);if(!v)return;S.setValue(`${v.type=="dir"?"cd":v.execute?"":"cat"} ${d.filepath.startsWith("/bin")?d.filepath.replace("/bin/",""):p(d.filepath)}`.trim())}}}),i.jsx(Ue,{...S})]})},xt=pe(function(){const[{type:r}]=re(),[t]=te();return i.jsxs(I,{children:[r=="oneshot"&&i.jsx(Fe,{}),t.showDevice&&i.jsx(Le,{}),t.showTerminal&&i.jsx(ct,{}),i.jsx(ut,{})]})}),ut=()=>{const{toggle:e,musicPopout:r}=ve(),t=!r;return i.jsx(K,{position:{bottom:5,right:5},children:i.jsx(V,{mounted:t,transition:"fade-up",keepMounted:!0,children:o=>i.jsx(D,{gap:0,style:o,children:i.jsx(D,{gap:5,align:"end"})})})})};export{xt as default};
