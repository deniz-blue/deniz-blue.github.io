var v=Object.defineProperty;var I=(n,e,t)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var A=(n,e,t)=>I(n,typeof e!="symbol"?e+"":e,t);import{r as a,w as j,O as S}from"./chunk-EF7DTUVF-CZdnL9OO.js";import{j as s}from"./jsx-runtime-BjG_zV1W.js";import{u as w,v as B,a as O,b as R,S as P,B as D,W as M,F as T,U as L,c as N}from"./SoulContext-Cx6BIJGp.js";import{L as G,u as E,b as x}from"./LanguageContext-BexENtC9.js";import"./use-force-update-DYUPA38B.js";const W=()=>a.useContext(G),C=n=>{const{language:e}=W(),r=n[e].split(/(#\w+#)/).map((c,h)=>{if(c[0]=="#"&&c[c.length-1]=="#"){const l=c.substring(1,c.length-1);return l in n||console.warn(`[@alan404/react-localization > Localized] Interpolation with key '${l}' not defined in props. If this is intentional, define it in props with undefined or null.`),s.jsx(a.Fragment,{children:n[l]},h)}else return s.jsx("span",{children:c},h)});return s.jsx(a.Fragment,{children:r})},z="/assets/IMAGE_DEPTH-CDYDeSwd.png",H="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",F=(n,e)=>{const t=a.useRef(n);t.current=n,a.useEffect(()=>{let i=performance.now();const r=()=>{performance.now()-i>=e&&(t.current(),i=performance.now()),c=requestAnimationFrame(r)};let c=requestAnimationFrame(r);return()=>{cancelAnimationFrame(c)}},[])},U=(n,e={})=>{const t=a.useRef(null),i=a.useRef(null),r=a.useRef(null);a.useEffect(()=>{var f,o,u;const l=t.current;if(!l)return;l.width=((f=e.size)==null?void 0:f.x)||l.clientWidth,l.height=((o=e.size)==null?void 0:o.y)||l.clientHeight;const g=l.getContext("2d",{alpha:!0,desynchronized:!0});return g?(i.current=g,r.current=n(g),()=>{var d,m;(m=(d=r.current)==null?void 0:d.destroy)==null||m.call(d),i.current=null}):(u=e==null?void 0:e.onFail)==null?void 0:u.call(e)},[n,t]);const c=a.useCallback(()=>{var l,g,f;(g=(l=r.current)==null?void 0:l.update)==null||g.call(l,1),i.current&&i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height),(f=r.current)==null||f.draw()},[e.noClear]);F(c,30);const h=a.useCallback(()=>{var l,g;t.current&&(t.current.width=((l=e.size)==null?void 0:l.x)||t.current.clientWidth,t.current.height=((g=e.size)==null?void 0:g.y)||t.current.clientHeight)},[t,e.size]);return E("resize",h),{ref:t}},b=()=>{const n=a.useRef(null),e=a.useCallback(()=>{var t;(t=n.current)==null||t.play().catch(()=>{})},[n]);return E("click",e,{once:!0}),n};class J{constructor(){A(this,"siner");A(this,"alpha");A(this,"xstretch");A(this,"ystretch");A(this,"o_insurance");A(this,"depth");A(this,"b_insurance");A(this,"OBSPEED");this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}draw(){this.siner>2}shouldDraw(){return this.siner>2}getAlpha(){return .2+this.alpha-this.o_insurance+this.b_insurance}}const _=()=>{w("ARE WE CONNECTED?");const n=a.useCallback(i=>{let r=new Set,c=new Image;c.src=z;let h=0,l=0,g=.5;const f=(o,u,d)=>{const m=c.width,k=c.height,p=160,y=120;i.save(),i.globalAlpha=d,i.translate(p,y),i.scale(o,u),i.drawImage(c,-m/2,-k/2),i.restore()};return{update(){if(h+=1,l+=g,l>=20){let o=new J;o.depth=5+h,o.OBSPEED=.01*g,o.destroy=()=>r.delete(o),r.add(o),h>=6e4&&(h=0),l=0}for(let o of r)o.step()},draw(){if(c.complete)for(let o of r){if(!o.shouldDraw())continue;let u=o.getAlpha();f(1+o.xstretch,1+o.ystretch,u),f(-1-o.xstretch,1+o.ystretch,u),f(-1-o.xstretch,-1-o.ystretch,u),f(1+o.xstretch,-1-o.ystretch,u)}}}},[]),{ref:e}=U(n,{size:B(320,240)}),t=b();return s.jsxs("div",{className:"pageBackground",children:[s.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"pixelated"},ref:e}),s.jsx("audio",{src:H,ref:t,autoPlay:!0,loop:!0})]})},Z="/assets/tree-DOnJeJ13.gif",Y="/assets/man-DVTDGMKe.ogg",V=()=>{const n=b();return w("* "),s.jsxs("div",{className:"pageBackground",children:[s.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${Z}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),s.jsx("audio",{src:Y,loop:!0,autoPlay:!0,ref:n})]})},X=()=>{const{myBurdenIsDead:n}=O(),[e]=a.useState(()=>[1,-1].map(t=>Array(128).fill(0).map((i,r)=>{const c=Math.floor(Math.random()*4)*5;return{key:t*(r+1),color:t>0?"#97257a":"#7463aa",size:c,top:Math.random()/2*100+(t==1?80:0)-20+"%",left:Math.random()*100+"%"}})).flat());return s.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)",height:"100vh"},children:[e.map(({key:t,size:i,color:r,top:c,left:h})=>s.jsx("div",{style:{backgroundColor:r,opacity:.7,width:i,height:i,position:"absolute",top:c,left:h}},t)),s.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),s.jsx("div",{className:"pageBackground",style:{opacity:n?1:0,backgroundColor:"black",zIndex:2},children:s.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})})]})},K=()=>{const[{type:n}]=R();return s.jsxs("div",{style:{position:"fixed",zIndex:-1},children:[n==="oneshot"&&s.jsx(X,{}),n==="depth"&&s.jsx(_,{}),n==="man"&&s.jsx(V,{})]})},q=a.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),Q=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],$=({children:n})=>{const e=a.useRef(null),t=a.useRef(null),i=a.useRef(null),[r,c]=a.useState(null),[h,l]=a.useState(!1),[g,f]=a.useState(!1);a.useEffect(()=>{let u=new Audio;return e.current=u,()=>{var d;(d=t.current)==null||d.close(),u.pause(),u.remove(),e.current=null}},[]),a.useEffect(()=>{if(!e.current)return;const u=new AbortController,{signal:d}=u;return e.current.addEventListener("playing",()=>{x.hide("music-error")},{signal:d}),()=>u.abort()},[]),a.useEffect(()=>{if(!e.current)return;const u=new AbortController,{signal:d}=u;return e.current.addEventListener("ended",()=>{if(!r)return;const m=Q;let k=m.indexOf(r);if(k==-1)return;let p=k+1;p>=m.length&&(p=0);let y=m[p];y&&c(y)},{signal:d}),()=>u.abort()},[r]),a.useEffect(()=>{if(r)return x.show({id:"music-nowplaying",title:s.jsx(C,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:r.title}),()=>void x.hide("music-nowplaying");x.hide("music-nowplaying")},[r]);const o=()=>{var u;(u=e.current)==null||u.play().then(()=>{t.current=new AudioContext;let d=t.current.createMediaElementSource(e.current);i.current=t.current.createAnalyser(),d.connect(i.current),d.connect(t.current.destination)}).catch(d=>{if(d instanceof DOMException&&d.name=="NotAllowedError"){x.show({id:"music-error",message:s.jsx(C,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const m=()=>o();window.addEventListener("click",m,{once:!0})}})};return a.useEffect(()=>{e.current&&(e.current.pause(),e.current.src=r?`/assets/music/${r.file}`:"",r&&o())},[r]),s.jsx(q.Provider,{value:{ref:e,loading:h,playing:g,currentSong:r,analyser:i,audioContext:t,changeCurrentSong:c},children:n})},ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",te=()=>{const{ref:n}=a.useContext(P);return s.jsx("div",{className:"fullscreen",style:{zIndex:-1},children:s.jsx("div",{id:"SOUL",style:{width:22,height:22,backgroundImage:`url("${ee}")`,transform:"translate(-100px, -100px)",transition:"transform 100ms"},ref:n})})},ne=({providers:n,children:e})=>s.jsx(s.Fragment,{children:n.reduceRight((t,i)=>s.jsx(i,{children:t}),e)}),le=j(function(){return s.jsxs(ne,{providers:[D,M,T,L,$,N],children:[s.jsx(K,{}),s.jsx(te,{}),s.jsx(S,{})]})});export{le as default};
