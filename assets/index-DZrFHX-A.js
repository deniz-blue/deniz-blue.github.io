import{a as g,p as c,w as V,q as Q,O as K}from"./chunk-4WY6JWTD-DausnuBa.js";import{u as $,a as ee,b as te,L as H,c as ne,d as O,e as re,B as se,W as oe,F as ae,A as ie}from"./useSoundEffect-Ci29didF.js";import{U as le}from"./UIContext-Cnb_0Nbg.js";import{u as j,C as ce,L as ue}from"./LanguageContext-Ff99D7wO.js";import{u as de}from"./use-isomorphic-effect-DaP3eo3O.js";import{a as S}from"./notifications.store-lTq-jTht.js";import"./factory-Chu4lyg_.js";import"./polymorphic-factory-A8nCz7JD.js";function J(e){de(()=>{typeof e=="string"&&e.trim().length>0&&(document.title=e.trim())},[e])}const fe="/assets/IMAGE_DEPTH_4-O8gd5XC3.png",he="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",ge=e=>h(e,e),h=(e,n)=>typeof e=="object"&&e!==null?{x:e.x||0,y:e.y||0}:{x:e||0,y:n||0},D=e=>typeof e=="object"&&e?h(e):ge(e),E=(...e)=>e.map(D).reduce((n,t)=>h(n.x+t.x,n.y+t.y)),N=(...e)=>e.map(D).reduce((n,t)=>h(n.x*t.x,n.y*t.y)),Ae=(e,n)=>E(e,N(n,-1)),me=(e,n)=>{let t=D(e),s=D(n);return h(t.x/s.x,t.y/s.y)};h(0,0);h(1,1);const pe=(e,n)=>{const t=g.useRef(e);t.current=e,g.useEffect(()=>{let s=performance.now();const r=()=>{performance.now()-s>=n&&(t.current(),s=performance.now()),i=requestAnimationFrame(r)};let i=requestAnimationFrame(r);return()=>{cancelAnimationFrame(i)}},[])},T=(e,n={})=>{const t=g.useRef(null),s=g.useRef(null),r=g.useRef(null),i=a=>{let{x:o,y:u}=typeof n.size=="function"?n.size(a):h(n.size?.x&&n.size?.x>0?n.size?.x:a.clientWidth,n.size?.y&&n.size?.y>0?n.size?.y:a.clientHeight);a.width=o,a.height=u};g.useEffect(()=>{const a=t.current;if(!a)return;i(a);const o=a.getContext("2d",{alpha:!0,desynchronized:!0});return o?(s.current=o,r.current=e(o),()=>{r.current?.destroy?.(),s.current=null}):n?.onFail?.()},[e,t]);const l=g.useCallback(()=>{r.current?.update?.(1),s.current&&s.current.clearRect(0,0,s.current.canvas.width,s.current.canvas.height),r.current?.draw()},[n.noClear]);pe(l,n.delay||30);const f=g.useCallback(()=>{t.current&&i(t.current)},[t,n.size]);return j("resize",f),{ref:t}},P=()=>{const e=g.useRef(null),n=g.useCallback(()=>{e.current?.play().catch(()=>{})},[e]);return j("click",n,{once:!0}),e};class ye{siner;alpha;xstretch;ystretch;o_insurance;depth;b_insurance;OBSPEED;constructor(){this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}shouldDraw(){return this.siner<150&&this.siner>2}getAlpha(){return Math.max(0,.2+this.alpha-this.o_insurance+this.b_insurance)}}const we=()=>{J("ARE WE CONNECTED?");const e=g.useCallback(s=>{let r=[],i=new Image;i.src=fe;let l=0,f=0,a=.5;return{update(){if(l+=1,f+=a,f>=20){let o=new ye;o.depth=5+l,o.OBSPEED=.01*a,o.destroy=()=>r=r.filter(u=>u!==o),r.unshift(o),l>=6e4&&(l=0),f=0}for(let o of r)o.step()},draw(){if(i.complete)for(let o of r){if(!o.shouldDraw())continue;let u=o.getAlpha();s.globalAlpha=u;const A=i.width*o.xstretch,p=i.height*o.ystretch;s.drawImage(i,160-A/2,120-p/2,A,p)}}}},[]),{ref:n}=T(e,{size:h(320,240)}),t=P();return c.jsxs("div",{className:"pageBackground",children:[c.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"crisp-edges"},ref:n}),c.jsx("audio",{src:he,ref:t,autoPlay:!0,loop:!0})]})},xe="/assets/tree-DOnJeJ13.gif",be="/assets/man-DVTDGMKe.ogg",Ce=()=>{const e=P();return J("* "),c.jsxs("div",{className:"pageBackground",children:[c.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${xe}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),c.jsx("audio",{src:be,loop:!0,autoPlay:!0,ref:e})]})},X=()=>{let e=49734321;return()=>(e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,(e&268435455)/268435456)},ve=()=>{const{myBurdenIsDead:e}=$(),n=s=>[1,-1].map(r=>Array(500).fill(0).map((i,l)=>{const f=s()/2*100*r+(r==-1?100:0),a=`${f}%`,o=Math.abs(f-50)/50,p=2+o*10;if(s()>o)return null;const C=o*.5,w=s();return{key:r*(l+1),color:r*(s()>.2?1:-1)>0?"#97257a":"#7463aa",size:p,top:a,left:s()*110-5+"%",opacity:C,animrand:w,dir:r}})).flat().filter(r=>!!r),t=g.useMemo(()=>n(X()),[]);return c.jsxs("div",{className:"scrollableBackground fullSize",style:{backgroundImage:"linear-gradient(#250630, #63173d)"},children:[t.map(({key:s,size:r,color:i,top:l,left:f,opacity:a,animrand:o,dir:u})=>c.jsx("div",{className:"oneshot-square",style:{backgroundColor:i,opacity:a,width:r,height:r,position:"absolute",top:l,left:f,"--animrand":o*100+"ms","--dir":u}},s)),c.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),c.jsx("div",{className:"pageBackground",style:{opacity:e?1:0,backgroundColor:"black",zIndex:2},children:c.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})})]})},I=(e=1)=>Math.round(Math.random()*e),ke=e=>e[I(e.length-1)],Ee="/assets/rain-XCcjA8b9.ogg",Me=["#0000FF","#0055EE","#0a205a","#0515a6"],Re=()=>{const e=g.useCallback(s=>{let r=new Set,i=h(),l=.4;const f=.002;return{update(a){for(let u of r)u.y+u.size*3>=s.canvas.height?(u.y=s.canvas.height,u.splash>1?r.delete(u):u.splash+=f*u.vy*a):(u.vy+=u.sinkSpeed*.03*a,u.x+=i.x*a,u.y+=u.vy*a+i.y*a);let o=Math.floor(l*s.canvas.width);for(;r.size<o;)r.add({x:I(s.canvas.width),y:-I(s.canvas.height*2),vy:0+Math.random(),color:ke(Me),sinkSpeed:I(15)+15,size:I(2)+3,splash:0,alpha:Math.random()+.1})},draw(){for(let a of r)if(s.fillStyle=a.color,s.globalAlpha=a.alpha,a.splash){const o=a.size*2,u=a.size*2,A=-1,w=(m=>y=>A*Math.pow(y-m.x,2)+m.y)(h(1,1))(a.splash*2)*u,b=a.size/2*(1.5-a.splash),d=a.size/2;s.fillRect(a.x+a.splash*o,a.y-w-d,b,b),s.fillRect(a.x-a.splash*o,a.y-w-d,b,b)}else s.fillRect(a.x,a.y,a.size/2,a.size*2+a.vy*.1)}}},[]),{ref:n}=T(e,{}),t=P();return c.jsxs("div",{className:"fullscreen",children:[c.jsx("canvas",{className:"fullscreen",ref:n}),c.jsx("audio",{src:Ee,ref:t,loop:!0,autoPlay:!0})]})},Se=()=>{const e=g.useCallback(t=>{t.lineWidth=1,t.imageSmoothingEnabled=!1;const s="#5A0D36",r="#6E1244",i="#290427",l="#4B092E",f="#2A0428",a="#B1184B",o="#1E021F",u="#FF59BE",A=(d,m,y,x)=>{t.fillStyle=y,t.fillRect(d.x,d.y,m.x,m.y),x&&(t.strokeStyle=x,t.strokeRect(d.x+.5,d.y+.5,m.x,m.y))},p=(d,m,y,x,v,B)=>{for(let M=0;M<y.x;M++)for(let k=0;k<y.y;k++)A(E(d,N(E(m,x),h(M,k))),m,v,B)},C=(d,m,y)=>{t.save(),t.globalAlpha=.5;let x=t.createRadialGradient(d.x,d.y,0,d.x,d.y,y);x.addColorStop(0,m+"ff"),x.addColorStop(1,m+"00"),t.beginPath(),t.fillStyle=x,t.arc(d.x,d.y,y,0,Math.PI*2,!1),t.fill(),t.restore()},w=({pos:d,padding:m,windowSize:y,windowSpacing:x,windowAmount:v,color:B,outlineColor:M,windowColor:k,windowUnderlineColor:R,windowLitIndicies:L,windowLitColor:z,windowLitSize:Z})=>{const G=h(m.x+y.x*v.x+x.x*(v.x-1)+m.x,t.canvas.height-d.y-1);if(A(d,G,B,M),p(E(d,m),y,v,x,k),R&&p(E(d,m,h(0,y.y)),h(y.x,1),v,h(x.x,x.y+y.y-1),R),z&&L?.length&&Z)for(let W of L){let F=N(h(W%v.x,Math.floor(W/v.y)),E(y,x)),q=E(d,m,F,me(y,2));C(q,u,15),A(E(d,m,F),y,z)}return{buildingSize:G}},b=({x:d,y:m,hl:y,frontWindowAmount:x,sideWindowAmount:v})=>{const k=Math.floor(t.canvas.height/14)-5,{buildingSize:R}=w({pos:h(d,m),padding:h(4,12),color:s,outlineColor:r,windowColor:f,windowSize:h(8,9),windowSpacing:h(5,5),windowAmount:h(x,k),windowUnderlineColor:a,windowLitColor:u,windowLitSize:15,windowLitIndicies:y});return w({pos:h(R.x+d+1,m),padding:h(4,12),color:i,outlineColor:l,windowColor:o,windowSize:h(4,9),windowSpacing:h(3,5),windowAmount:h(v,k)}),{frontSize:R}};return{draw(){t.lineJoin="miter",t.lineCap="square",t.strokeStyle="blue";let d=X(),m=4;for(let y of Array(20).fill(0)){let x=[...new Set(Array(5).fill(0).map(()=>Math.floor(d()*1e3)))],{frontSize:v}=b({x:m,y:t.canvas.height-Math.floor(t.canvas.height*d()*.7),frontWindowAmount:5,sideWindowAmount:3,hl:x});m+=v.x,m+=d()>.9?50:0,m+=4}}}},[]),{ref:n}=T(e,{delay:500,size:t=>{const r=480/t.clientHeight*t.clientWidth;return h(r,480)}});return c.jsx("div",{className:"pageBackground",children:c.jsx("canvas",{className:"pageBackground",style:{imageRendering:"crisp-edges",backgroundImage:"linear-gradient(#18031A, #23051F, #3B0929)"},ref:n})})},_=h(320,180),Ie=g.memo(()=>{const[e,n]=g.useState(!1);return g.useEffect(()=>{const t=requestAnimationFrame(()=>n(!0));return()=>cancelAnimationFrame(t)},[]),c.jsx("div",{className:"pageBackground",style:{backgroundImage:"url('/assets/img/detail/sky.png')",backgroundRepeat:"repeat",backgroundAttachment:"fixed"},children:e&&c.jsx(je,{})})}),je=()=>{const e=g.useRef(null),n=g.useRef(null);return g.useRef(null),g.useEffect(()=>{let t=new AbortController,s=t.signal;const r=requestAnimationFrame(()=>{if(s.aborted)return;const i=e.current;if(!i)return;i.width=i.clientWidth,i.height=i.clientHeight;const l=i.transferControlToOffscreen(),f=new Worker(new URL("/assets/effects.worker-Cp36qsWT.js",import.meta.url),{type:"module"});f.postMessage({type:"init",data:l},[l]),n.current=f,window.addEventListener("scroll",()=>{f.postMessage({type:"scroll",data:h(0,window.scrollY)})},{signal:s})});return()=>{cancelAnimationFrame(r),n.current?.terminate(),t.abort(),n.current=null}},[]),j("resize",()=>{const t=e.current;t&&n.current?.postMessage({type:"dimensionsChange",data:h(t.clientWidth,t.clientHeight)})}),c.jsx("canvas",{ref:e,className:"fullscreenDynamic",style:{objectFit:"contain",aspectRatio:_.x/_.y,imageRendering:"pixelated"}})},Be=()=>{const[{type:e}]=ee(),[{rain:n}]=te();return c.jsxs("div",{style:{position:"absolute",zIndex:-1,pointerEvents:"none",width:"100%",height:"100%",inset:0,minHeight:"100svh"},children:[n&&c.jsx(Re,{}),e==="starfield"&&c.jsx(Ie,{}),e==="oneshot"&&c.jsx(ve,{}),e==="depth"&&c.jsx(we,{}),e==="man"&&c.jsx(Ce,{}),e==="refuge"&&c.jsx(Se,{})]})},De=g.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),Oe=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],Ne=({children:e})=>{const n=g.useRef(null),t=g.useRef(null),s=g.useRef(null),[r,i]=g.useState(null),[l,f]=g.useState(!1),[a,o]=g.useState(!1);g.useEffect(()=>{let A=new Audio;return n.current=A,()=>{t.current?.close(),A.pause(),A.remove(),n.current=null}},[]),g.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:p}=A;return n.current.addEventListener("playing",()=>{S.hide("music-error")},{signal:p}),()=>A.abort()},[]),g.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:p}=A;return n.current.addEventListener("ended",()=>{if(!r)return;const C=Oe;let w=C.indexOf(r);if(w==-1)return;let b=w+1;b>=C.length&&(b=0);let d=C[b];d&&i(d)},{signal:p}),()=>A.abort()},[r]),g.useEffect(()=>{if(r)return S.show({id:"music-nowplaying",title:c.jsx(H,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:r.title}),()=>void S.hide("music-nowplaying");S.hide("music-nowplaying")},[r]);const u=()=>{n.current?.play().then(()=>{t.current=new AudioContext;let A=t.current.createMediaElementSource(n.current);s.current=t.current.createAnalyser(),A.connect(s.current),A.connect(t.current.destination)}).catch(A=>{if(A instanceof DOMException&&A.name=="NotAllowedError"){S.show({id:"music-error",message:c.jsx(H,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const p=()=>u();window.addEventListener("click",p,{once:!0})}})};return g.useEffect(()=>{n.current&&(n.current.pause(),n.current.src=r?`/assets/music/${r.file}`:"",r&&u())},[r]),c.jsx(De.Provider,{value:{ref:n,loading:l,playing:a,currentSong:r,analyser:s,audioContext:t,changeCurrentSong:i},children:e})},Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAAAAAAAAPlDu38AAAAHdElNRQfpCAoOASJktxbgAAAA6UlEQVQ4y9WTIQ7CQBBFXwmqWGpBo6u5CdwBzQHQWDTcBF2NBguWWjAz4bMM7Ur4yaZN+/flZaeFX0/hN4/XszUwAu7ARks5nRS4AuZSPgLbRCLsOGgoxQUwA2optwbYCqxOOjfbe0iBEwNWQGmrTuwcpp0ZcPaCAqdSwq6VAXYCrJJOaXs/gFEUSgILkwMsgTGZGeQWc6OGZzkPPctvaW2dkKGo4cVeXq3Yl9a6J9sLxH/KntcgIlM3awy4VFA0lMaAE+KpupkD31KkDzpMHRaaRUPpM6XL7Kthh6kDl10b+z5sNXXgn+cJ6No9ST9X3LMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMDgtMTBUMTQ6MDE6MzQrMDA6MDABpoTaAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTA4LTEwVDE0OjAxOjM0KzAwOjAwcPs8ZgAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0wOC0xMFQxNDowMTozNCswMDowMCfuHbkAAAAASUVORK5CYII=",Y=ne()((e,n)=>({ref:{current:null}})),Le=()=>{const{ref:e}=Y();return c.jsxs("div",{id:"SOUL",ref:e,children:[c.jsx("div",{className:"soul heart",style:{backgroundImage:`url("${Te}")`}}),c.jsx("div",{className:"soul blur",style:{backgroundImage:`url("${Pe}")`}})]})},ze=({providers:e,children:n})=>c.jsx(c.Fragment,{children:e.reduceRight((t,s)=>c.jsx(s,{children:t}),n)}),U=(e,{pos:n,zIndex:t,opacity:s,blur:r})=>{n&&(e.style.transform=`translate(${n.x-11}px, ${n.y-11+window.scrollY}px)`),t!==void 0&&(e.style.zIndex=t?t.toString():""),s!==void 0&&(e.style.opacity=s.toString()),e.style.setProperty("--blur",r?"1":"0")},Ge=e=>{const n=e.getBoundingClientRect(),t=32,s=window.innerWidth,r=window.innerHeight;let i=0,l=0;n.left<t?i=n.left-t:n.right>s-t&&(i=n.right-(s-t)),n.top<t?l=n.top-t:n.bottom>r-t&&(l=n.bottom-(r-t)),(i!==0||l!==0)&&window.scrollBy({left:i,top:l,behavior:"smooth"})},We=e=>{let n=e.getAttribute("data-soul-anchor")||"center",t=e.getBoundingClientRect(),s=!!e.getAttribute("data-soul-blur");const r=(b,d)=>{let m=e.getAttribute(b);return m!==null&&!isNaN(Number(m))?Number(m):d};let i=r("data-soul-z",0);const l=4;let f=r("data-soul-mt",l),a=r("data-soul-mb",l),o=r("data-soul-ml",l),u=r("data-soul-mr",l),A="center",p="center";if(n!="center"){if(n?.includes("-")){let[b,d]=n.split("-");A=b.replace("left","start").replace("right","end"),p=d.replace("top","start").replace("bottom","end")}}let C;if(A=="center")C=t.x+t.width/2+u-o;else if(A=="start")C=t.x-o;else if(A=="end")C=t.x+t.width+u;else throw new Error("Invalid state");let w;if(p=="center")w=t.y+t.height/2+f-a;else if(p=="start")w=t.y-f;else if(p=="end")w=t.y+t.height+a;else throw new Error("Invalid state");return{pos:h(C,w),zIndex:i,blur:s}};function Fe(e,n,t){const s=e?.getBoundingClientRect(),r=s?h(s.left+s.width/2,s.top+s.height/2):h();let i=n.map(o=>{if(o==e)return null;const u=o.getBoundingClientRect(),A=h(u.left+u.width/2,u.top+u.height/2),p=Ae(A,r),C=Math.hypot(p.x,p.y);let w=Math.atan2(p.y,p.x);const b=["right","down","left","up"][Math.round((w+Math.PI*2)%(Math.PI*2)/(Math.PI/2))%4];return{node:o,delta:p,dist:C,angle:w,direction:b}}).filter(o=>o!==null).sort((o,u)=>o.dist-u.dist);const l=i.filter(o=>{if(t=="down")return o.delta.y>0;if(t=="up")return o.delta.y<0;if(t=="left")return o.delta.x<0;if(t=="right")return o.delta.x>0}),f=l.find(o=>o.direction=="up"||o.direction=="down"?o.delta.x==0:o.delta.y==0);return f&&i.indexOf(f)<4?f.node:l[0]?.node??null}const He="/assets/OneShotMenuCursor-BmwqYD4l.wav",_e="/assets/OneShotMenuDecision-CtfpWGTn.wav",Ue="/assets/OneShotMenuCancel-BbAlDvoI.wav",Je=()=>{const{ref:e}=Y(),{play:n}=O(He),{play:t}=O(_e),{play:s}=O(Ue),r=g.useRef(null),i=()=>{if(!document.activeElement?.classList.contains("soulSelectable"))return;let f=r.current,a=f!==document.activeElement;if(r.current=document.activeElement??null,a&&f?.removeAttribute("data-soul-selected"),r.current?.setAttribute("data-soul-selected","true"),!!e.current)if(r.current){a&&n(),r.current.focus();const{...o}=We(r.current);U(e.current,{opacity:1,...o})}else U(e.current,{pos:h(),opacity:0})},l=f=>{const a=[...document.querySelectorAll(".soulSelectable")],o=Fe(r.current,a,f);o&&(Ge(o),o.focus(),i())};return re([["ArrowUp",()=>l("up")],["w",()=>l("up")],["ArrowDown",()=>l("down")],["s",()=>l("down")],["ArrowLeft",()=>l("left")],["a",()=>l("left")],["ArrowRight",()=>l("right")],["d",()=>l("right")],["Enter",()=>{let f=r.current;f&&(console.log(f),f.dataset.active?s():t(),f.click())}]]),j("keydown",()=>{setTimeout(i,0)}),j("keyup",()=>{setTimeout(i,0)}),null},et=V(function(){return c.jsxs(ze,{providers:[se,oe,ae,ie,le,Ne],children:[c.jsx(Be,{}),c.jsx(Le,{}),c.jsx(Je,{}),c.jsx(K,{})]})}),tt=Q(function(){return c.jsx(ce,{my:"xl",h:"90vh",children:c.jsx(ue,{})})});export{tt as HydrateFallback,et as default};
