import{a as s,w as j,O as I}from"./chunk-C37GKA54-C1SU4sNO.js";import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{u as v,v as y,a as S,b as R,S as B,B as M,W as O,F as D,A as P,U as T,c as L}from"./AppContext-CUrJxGGg.js";import{a as w}from"./use-window-event-UTFVsWTy.js";import{L as N,a as A}from"./LanguageContext-gZG8NHOH.js";const F=()=>s.useContext(N),C=n=>{const{language:e}=F(),r=n[e].split(/(#\w+#)/).map((o,u)=>{if(o[0]=="#"&&o[o.length-1]=="#"){const d=o.substring(1,o.length-1);return d in n||console.warn(`[@alan404/react-localization > Localized] Interpolation with key '${d}' not defined in props. If this is intentional, define it in props with undefined or null.`),a.jsx(s.Fragment,{children:n[d]},u)}else return a.jsx("span",{children:o},u)});return a.jsx(s.Fragment,{children:r})},G="/assets/IMAGE_DEPTH-CDYDeSwd.png",W="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",z=(n,e)=>{const t=s.useRef(n);t.current=n,s.useEffect(()=>{let i=performance.now();const r=()=>{performance.now()-i>=e&&(t.current(),i=performance.now()),o=requestAnimationFrame(r)};let o=requestAnimationFrame(r);return()=>{cancelAnimationFrame(o)}},[])},H=(n,e={})=>{const t=s.useRef(null),i=s.useRef(null),r=s.useRef(null);s.useEffect(()=>{const d=t.current;if(!d)return;d.width=e.size?.x||d.clientWidth,d.height=e.size?.y||d.clientHeight;const g=d.getContext("2d",{alpha:!0,desynchronized:!0});return g?(i.current=g,r.current=n(g),()=>{r.current?.destroy?.(),i.current=null}):e?.onFail?.()},[n,t]);const o=s.useCallback(()=>{r.current?.update?.(1),i.current&&i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height),r.current?.draw()},[e.noClear]);z(o,30);const u=s.useCallback(()=>{t.current&&(t.current.width=e.size?.x||t.current.clientWidth,t.current.height=e.size?.y||t.current.clientHeight)},[t,e.size]);return w("resize",u),{ref:t}},b=()=>{const n=s.useRef(null),e=s.useCallback(()=>{n.current?.play().catch(()=>{})},[n]);return w("click",e,{once:!0}),n};class U{siner;alpha;xstretch;ystretch;o_insurance;depth;b_insurance;OBSPEED;constructor(){this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}draw(){this.siner>2}shouldDraw(){return this.siner>2}getAlpha(){return .2+this.alpha-this.o_insurance+this.b_insurance}}const J=()=>{v("ARE WE CONNECTED?");const n=s.useCallback(i=>{let r=new Set,o=new Image;o.src=G;let u=0,d=0,g=.5;const f=(c,l,h)=>{const m=o.width,x=o.height,p=160,k=120;i.save(),i.globalAlpha=h,i.translate(p,k),i.scale(c,l),i.drawImage(o,-m/2,-x/2),i.restore()};return{update(){if(u+=1,d+=g,d>=20){let c=new U;c.depth=5+u,c.OBSPEED=.01*g,c.destroy=()=>r.delete(c),r.add(c),u>=6e4&&(u=0),d=0}for(let c of r)c.step()},draw(){if(o.complete)for(let c of r){if(!c.shouldDraw())continue;let l=c.getAlpha();f(1+c.xstretch,1+c.ystretch,l),f(-1-c.xstretch,1+c.ystretch,l),f(-1-c.xstretch,-1-c.ystretch,l),f(1+c.xstretch,-1-c.ystretch,l)}}}},[]),{ref:e}=H(n,{size:y(320,240)}),t=b();return a.jsxs("div",{className:"pageBackground",children:[a.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"pixelated"},ref:e}),a.jsx("audio",{src:W,ref:t,autoPlay:!0,loop:!0})]})},_="/assets/tree-DOnJeJ13.gif",Z="/assets/man-DVTDGMKe.ogg",Y=()=>{const n=b();return v("* "),a.jsxs("div",{className:"pageBackground",children:[a.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${_}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),a.jsx("audio",{src:Z,loop:!0,autoPlay:!0,ref:n})]})},V=()=>{const{myBurdenIsDead:n}=S(),[e]=s.useState(()=>[1,-1].map(t=>Array(128).fill(0).map((i,r)=>{const o=Math.floor(Math.random()*4)*5;return{key:t*(r+1),color:t>0?"#97257a":"#7463aa",size:o,top:Math.random()/2*100+(t==1?80:0)-20+"%",left:Math.random()*100+"%"}})).flat());return a.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)",height:"100vh"},children:[e.map(({key:t,size:i,color:r,top:o,left:u})=>a.jsx("div",{style:{backgroundColor:r,opacity:.7,width:i,height:i,position:"absolute",top:o,left:u}},t)),a.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),a.jsx("div",{className:"pageBackground",style:{opacity:n?1:0,backgroundColor:"black",zIndex:2},children:a.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})})]})},E=y(320,180),X=()=>{const[n,e]=s.useState(!1);return s.useEffect(()=>{const t=requestAnimationFrame(()=>e(!0));return()=>cancelAnimationFrame(t)},[]),a.jsx("div",{className:"pageBackground",style:{backgroundImage:"url('/assets/img/detail/sky.png')",backgroundRepeat:"repeat",backgroundAttachment:"fixed"},children:n&&a.jsx(q,{})})},q=()=>{const n=s.useRef(null),e=s.useRef(null);return s.useRef(null),s.useEffect(()=>{let t=!1;const i=requestAnimationFrame(()=>{if(t)return;const r=n.current;if(!r)return;r.width=r.clientWidth,r.height=r.clientHeight;const o=r.transferControlToOffscreen(),u=new Worker(new URL("/assets/effects.worker-BedSRFv2.js",import.meta.url),{type:"module"});u.postMessage({type:"init",data:o},[o]),e.current=u});return()=>{cancelAnimationFrame(i),e.current?.terminate(),e.current=null,t=!0}},[]),w("resize",()=>{const t=n.current;t&&e.current?.postMessage({type:"dimensionsChange",data:y(t.clientWidth,t.clientHeight)})}),a.jsx("canvas",{ref:n,className:"pageBackground",style:{objectFit:"contain",aspectRatio:E.x/E.y,imageRendering:"pixelated"}})},K=()=>{const[{type:n}]=R();return a.jsxs("div",{style:{position:"fixed",zIndex:-1},children:[n==="starfield"&&a.jsx(X,{},Date.now()),n==="oneshot"&&a.jsx(V,{}),n==="depth"&&a.jsx(J,{}),n==="man"&&a.jsx(Y,{})]})},Q=s.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),$=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],ee=({children:n})=>{const e=s.useRef(null),t=s.useRef(null),i=s.useRef(null),[r,o]=s.useState(null),[u,d]=s.useState(!1),[g,f]=s.useState(!1);s.useEffect(()=>{let l=new Audio;return e.current=l,()=>{t.current?.close(),l.pause(),l.remove(),e.current=null}},[]),s.useEffect(()=>{if(!e.current)return;const l=new AbortController,{signal:h}=l;return e.current.addEventListener("playing",()=>{A.hide("music-error")},{signal:h}),()=>l.abort()},[]),s.useEffect(()=>{if(!e.current)return;const l=new AbortController,{signal:h}=l;return e.current.addEventListener("ended",()=>{if(!r)return;const m=$;let x=m.indexOf(r);if(x==-1)return;let p=x+1;p>=m.length&&(p=0);let k=m[p];k&&o(k)},{signal:h}),()=>l.abort()},[r]),s.useEffect(()=>{if(r)return A.show({id:"music-nowplaying",title:a.jsx(C,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:r.title}),()=>void A.hide("music-nowplaying");A.hide("music-nowplaying")},[r]);const c=()=>{e.current?.play().then(()=>{t.current=new AudioContext;let l=t.current.createMediaElementSource(e.current);i.current=t.current.createAnalyser(),l.connect(i.current),l.connect(t.current.destination)}).catch(l=>{if(l instanceof DOMException&&l.name=="NotAllowedError"){A.show({id:"music-error",message:a.jsx(C,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const h=()=>c();window.addEventListener("click",h,{once:!0})}})};return s.useEffect(()=>{e.current&&(e.current.pause(),e.current.src=r?`/assets/music/${r.file}`:"",r&&c())},[r]),a.jsx(Q.Provider,{value:{ref:e,loading:u,playing:g,currentSong:r,analyser:i,audioContext:t,changeCurrentSong:o},children:n})},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",ne=()=>{const{ref:n}=s.useContext(B);return a.jsx("div",{className:"fullscreen",style:{zIndex:-1},children:a.jsx("div",{id:"SOUL",style:{width:22,height:22,backgroundImage:`url("${te}")`,transform:"translate(-100px, -100px)",transition:"transform 100ms"},ref:n})})},re=({providers:n,children:e})=>a.jsx(a.Fragment,{children:n.reduceRight((t,i)=>a.jsx(i,{children:t}),e)}),le=j(function(){return a.jsxs(re,{providers:[M,O,D,P,T,ee,L],children:[a.jsx(K,{}),a.jsx(ne,{}),a.jsx(I,{})]})});export{le as default};
