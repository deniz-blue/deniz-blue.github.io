import{a as l,w as J,O as X}from"./chunk-ZYFC6VSF-BZmslxjh.js";import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{v as h,u as F,a as Y,b as E,c as z,d as Z,e as Q,f as V,L,S as K,B as q,W as $,F as ee,A as te,U as ne,g as re}from"./SoulContext-DDkbbm2q.js";import{a as B}from"./LanguageContext-Dp3_LK6K.js";import{a as S}from"./notifications.store-Bsq0dQV7.js";const se="/assets/IMAGE_DEPTH_4-O8gd5XC3.png",ae="/assets/AUDIO_ANOTHERHIM-D8FEBsaZ.ogg",oe=(t,n)=>{const e=l.useRef(t);e.current=t,l.useEffect(()=>{let i=performance.now();const s=()=>{performance.now()-i>=n&&(e.current(),i=performance.now()),u=requestAnimationFrame(s)};let u=requestAnimationFrame(s);return()=>{cancelAnimationFrame(u)}},[])},D=(t,n={})=>{const e=l.useRef(null),i=l.useRef(null),s=l.useRef(null),u=g=>{let{x:o,y}=typeof n.size=="function"?n.size(g):h(n.size?.x&&n.size?.x>0?n.size?.x:g.clientWidth,n.size?.y&&n.size?.y>0?n.size?.y:g.clientHeight);g.width=o,g.height=y};l.useEffect(()=>{const g=e.current;if(!g)return;u(g);const o=g.getContext("2d",{alpha:!0,desynchronized:!0});return o?(i.current=o,s.current=t(o),()=>{s.current?.destroy?.(),i.current=null}):n?.onFail?.()},[t,e]);const m=l.useCallback(()=>{s.current?.update?.(1),i.current&&i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height),s.current?.draw()},[n.noClear]);oe(m,n.delay||30);const r=l.useCallback(()=>{e.current&&u(e.current)},[e,n.size]);return B("resize",r),{ref:e}},U=()=>{const t=l.useRef(null),n=l.useCallback(()=>{t.current?.play().catch(()=>{})},[t]);return B("click",n,{once:!0}),t};class ie{siner;alpha;xstretch;ystretch;o_insurance;depth;b_insurance;OBSPEED;constructor(){this.siner=0,this.alpha=.2,this.xstretch=1,this.ystretch=1,this.o_insurance=0,this.depth=4,this.OBSPEED=.02,this.b_insurance=-.2}destroy(){}step(){this.siner+=1,this.OBSPEED>0&&(this.alpha=Math.sin(this.siner/34)*.2),this.ystretch+=this.OBSPEED,this.xstretch+=this.OBSPEED,this.b_insurance<0&&(this.b_insurance+=.01),this.ystretch>2&&(this.o_insurance+=.01,this.o_insurance>=.5&&this.destroy())}shouldDraw(){return this.siner<150&&this.siner>2}getAlpha(){return Math.max(0,.2+this.alpha-this.o_insurance+this.b_insurance)}}const le=()=>{F("ARE WE CONNECTED?");const t=l.useCallback(i=>{let s=[],u=new Image;u.src=se;let m=0,r=0,g=.5;return{update(){if(m+=1,r+=g,r>=20){let o=new ie;o.depth=5+m,o.OBSPEED=.01*g,o.destroy=()=>s=s.filter(y=>y!==o),s.unshift(o),m>=6e4&&(m=0),r=0}for(let o of s)o.step()},draw(){if(u.complete)for(let o of s){if(!o.shouldDraw())continue;let y=o.getAlpha();i.globalAlpha=y;const A=u.width*o.xstretch,x=u.height*o.ystretch;i.drawImage(u,160-A/2,120-x/2,A,x)}}}},[]),{ref:n}=D(t,{size:h(320,240)}),e=U();return a.jsxs("div",{className:"pageBackground",children:[a.jsx("canvas",{className:"pageBackground",style:{objectFit:"cover",imageRendering:"crisp-edges"},ref:n}),a.jsx("audio",{src:ae,ref:e,autoPlay:!0,loop:!0})]})},ce="/assets/tree-DOnJeJ13.gif",ue="/assets/man-DVTDGMKe.ogg",de=()=>{const t=U();return F("* "),a.jsxs("div",{className:"pageBackground",children:[a.jsx("div",{className:"fullscreen",style:{backgroundImage:`url("${ce}")`,backgroundPosition:"center center",backgroundRepeat:"no-repeat"}}),a.jsx("audio",{src:ue,loop:!0,autoPlay:!0,ref:t})]})},he=()=>{const{myBurdenIsDead:t}=Y(),[n]=l.useState(()=>[1,-1].map(e=>Array(128).fill(0).map((i,s)=>{const u=Math.floor(Math.random()*4)*5;return{key:e*(s+1),color:e>0?"#97257a":"#7463aa",size:u,top:Math.random()/2*100+(e==1?80:0)-20+"%",left:Math.random()*100+"%"}})).flat());return a.jsxs("div",{className:"pageBackground",style:{backgroundImage:"linear-gradient(#250630, #63173d)",height:"100vh"},children:[n.map(({key:e,size:i,color:s,top:u,left:m})=>a.jsx("div",{style:{backgroundColor:s,opacity:.7,width:i,height:i,position:"absolute",top:u,left:m}},e)),a.jsx("img",{src:"/assets/img/detail/oneshot/NikoPromoTransparent.png",style:{position:"absolute",bottom:"calc(-60px)",maxHeight:"200px",maxWidth:"70vw",marginLeft:"1rem"}}),a.jsx("div",{className:"pageBackground",style:{opacity:t?1:0,backgroundColor:"black",zIndex:2},children:a.jsx("img",{src:"/assets/img/detail/oneshot/NikoDead.png",style:{position:"absolute",bottom:"0px",maxHeight:"200px",maxWidth:"80vw",marginLeft:"1rem"}})})]})},j=(t=1)=>Math.round(Math.random()*t),Ae=t=>t[j(t.length-1)],ge=["#0000FF","#0055EE","#0a205a","#0515a6"],fe=()=>{const t=l.useCallback(e=>{let i=new Set,s=h(),u=.1;const m=.002;return{update(r){for(let o of i)o.y+o.size*3>=e.canvas.height?(o.y=e.canvas.height,o.splash>1?i.delete(o):o.splash+=m*o.vy*r):(o.vy+=o.sinkSpeed*.03*r,o.x+=s.x*r,o.y+=o.vy*r+s.y*r);let g=Math.floor(u*e.canvas.width);for(;i.size<g;)i.add({x:j(e.canvas.width),y:-j(e.canvas.height*2),vy:0,color:Ae(ge),sinkSpeed:j(15)+15,size:j(2)+3,splash:0,alpha:Math.random()+.1})},draw(){for(let r of i)if(e.fillStyle=r.color,e.globalAlpha=r.alpha,r.splash){const g=r.size*2,o=r.size*2,y=-1,C=(c=>d=>y*Math.pow(d-c.x,2)+c.y)(h(1,1))(r.splash*2)*o,k=r.size/2*(1.5-r.splash),v=r.size/2;e.fillRect(r.x+r.splash*g,r.y-C-v,k,k),e.fillRect(r.x-r.splash*g,r.y-C-v,k,k)}else e.fillRect(r.x,r.y,r.size/2,r.size*2+r.vy*.1)}}},[]),{ref:n}=D(t,{});return a.jsx("div",{className:"fullscreen",children:a.jsx("canvas",{className:"fullscreen",ref:n})})},me=()=>{let t=49734321;return()=>(t=t+2127912214+(t<<12)&4294967295,t=(t^3345072700^t>>>19)&4294967295,t=t+374761393+(t<<5)&4294967295,t=(t+3550635116^t<<9)&4294967295,t=t+4251993797+(t<<3)&4294967295,t=(t^3042594569^t>>>16)&4294967295,(t&268435455)/268435456)},pe=()=>{const t=l.useCallback(e=>{e.lineWidth=1,e.imageSmoothingEnabled=!1;const i="#5A0D36",s="#6E1244",u="#290427",m="#4B092E",r="#2A0428",g="#B1184B",o="#1E021F",y="#FF59BE",A=(c,d,f,p)=>{e.fillStyle=f,e.fillRect(c.x,c.y,d.x,d.y),p&&(e.strokeStyle=p,e.strokeRect(c.x+.5,c.y+.5,d.x,d.y))},x=(c,d,f,p,w,I)=>{for(let M=0;M<f.x;M++)for(let b=0;b<f.y;b++)A(E(c,z(E(d,p),h(M,b))),d,w,I)},C=(c,d,f)=>{e.save(),e.globalAlpha=.5;let p=e.createRadialGradient(c.x,c.y,0,c.x,c.y,f);p.addColorStop(0,d+"ff"),p.addColorStop(1,d+"00"),e.beginPath(),e.fillStyle=p,e.arc(c.x,c.y,f,0,Math.PI*2,!1),e.fill(),e.restore()},k=({pos:c,padding:d,windowSize:f,windowSpacing:p,windowAmount:w,color:I,outlineColor:M,windowColor:b,windowUnderlineColor:R,windowLitIndicies:O,windowLitColor:N,windowLitSize:H})=>{const G=h(d.x+f.x*w.x+p.x*(w.x-1)+d.x,e.canvas.height-c.y-1);if(A(c,G,I,M),x(E(c,d),f,w,p,b),R&&x(E(c,d,h(0,f.y)),h(f.x,1),w,h(p.x,p.y+f.y-1),R),N&&O?.length&&H)for(let P of O){let T=z(h(P%w.x,Math.floor(P/w.y)),E(f,p)),_=E(c,d,T,Z(f,2));C(_,y,15),A(E(c,d,T),f,N)}return{buildingSize:G}},v=({x:c,y:d,hl:f,frontWindowAmount:p,sideWindowAmount:w})=>{const b=Math.floor(e.canvas.height/14)-5,{buildingSize:R}=k({pos:h(c,d),padding:h(4,12),color:i,outlineColor:s,windowColor:r,windowSize:h(8,9),windowSpacing:h(5,5),windowAmount:h(p,b),windowUnderlineColor:g,windowLitColor:y,windowLitSize:15,windowLitIndicies:f});return k({pos:h(R.x+c+1,d),padding:h(4,12),color:u,outlineColor:m,windowColor:o,windowSize:h(4,9),windowSpacing:h(3,5),windowAmount:h(w,b)}),{frontSize:R}};return{draw(){e.lineJoin="miter",e.lineCap="square",e.strokeStyle="blue";let c=me(),d=4;for(let f of Array(20).fill(0)){let p=[...new Set(Array(5).fill(0).map(()=>Math.floor(c()*1e3)))],{frontSize:w}=v({x:d,y:e.canvas.height-Math.floor(e.canvas.height*c()*.7),frontWindowAmount:5,sideWindowAmount:3,hl:p});d+=w.x,d+=c()>.9?50:0,d+=4}}}},[]),{ref:n}=D(t,{delay:500,size:e=>{const s=480/e.clientHeight*e.clientWidth;return h(s,480)}});return a.jsx("div",{className:"pageBackground",children:a.jsx("canvas",{className:"pageBackground",style:{imageRendering:"crisp-edges",backgroundImage:"linear-gradient(#18031A, #23051F, #3B0929)"},ref:n})})},W=h(320,180),ye=l.memo(()=>{const[t,n]=l.useState(!1);return l.useEffect(()=>{const e=requestAnimationFrame(()=>n(!0));return()=>cancelAnimationFrame(e)},[]),a.jsx("div",{className:"pageBackground",style:{backgroundImage:"url('/assets/img/detail/sky.png')",backgroundRepeat:"repeat",backgroundAttachment:"fixed"},children:t&&a.jsx(xe,{})})}),xe=()=>{const t=l.useRef(null),n=l.useRef(null);return l.useRef(null),l.useEffect(()=>{let e=new AbortController,i=e.signal;const s=requestAnimationFrame(()=>{if(i.aborted)return;const u=t.current;if(!u)return;u.width=u.clientWidth,u.height=u.clientHeight;const m=u.transferControlToOffscreen(),r=new Worker(new URL("/assets/effects.worker-DQ-p0nJE.js",import.meta.url),{type:"module"});r.postMessage({type:"init",data:m},[m]),n.current=r,window.addEventListener("scroll",()=>{r.postMessage({type:"scroll",data:h(0,window.scrollY)})},{signal:i})});return()=>{cancelAnimationFrame(s),n.current?.terminate(),e.abort(),n.current=null}},[]),B("resize",()=>{const e=t.current;e&&n.current?.postMessage({type:"dimensionsChange",data:h(e.clientWidth,e.clientHeight)})}),a.jsx("canvas",{ref:t,className:"fullscreenDynamic",style:{objectFit:"contain",aspectRatio:W.x/W.y,imageRendering:"pixelated"}})},we=()=>{const[{type:t}]=Q(),[{rain:n}]=V();return a.jsxs("div",{style:{position:"fixed",zIndex:-1},children:[n&&a.jsx(fe,{}),t==="starfield"&&a.jsx(ye,{}),t==="oneshot"&&a.jsx(he,{}),t==="depth"&&a.jsx(le,{}),t==="man"&&a.jsx(de,{}),t==="refuge"&&a.jsx(pe,{})]})},ke=l.createContext({ref:{current:null},analyser:{current:null},audioContext:{current:null},currentSong:null,loading:!0,playing:!1,changeCurrentSong:()=>{}}),Ce=[{title:"Fear of the Unknown",artist:"Lena Raine",cover:"celestefarewell.jpg",file:"Fear of the Unknown.mp3"},{title:"world.execute(me);",artist:"Mili",cover:"miraclemilk.jpg",file:"worldexecuteme.m4a"},{title:"Confessions of a Rotten Girl",artist:"SAWTOWNE",cover:"ConfessionsOfARottenGirl.png",file:"ConfessionsOfARottenGirl.mp3"},{title:"Medicine",romanji:"Igaku",artist:"Sasuke Haraguchi",originalTitle:"イガク",cover:"igaku.png",file:"igaku.mp3"},{title:"Flower of Transformation",romanji:"Bake no Hana",originalTitle:"化けの花",artist:"NAKISO",cover:"mizu5.png",file:"bakenohana.mp3"},{title:"Substitute",romanji:"Hitogawari",originalTitle:"ヒトガワリ",artist:"KikuoHana",file:"hitogawari.mp3",cover:"kikuohana2.png"},{title:"Take Me To The Beach (feat. Ado)",file:"TakeMeToTheBeach.mp3",cover:"TakeMeToTheBeach.png",artist:"Imagine Dragons"},{title:"A Fool Moon Night",artist:"THE KOXX",cover:"thekoxx.png",file:"afoolmoonnight.mp3"}],ve=({children:t})=>{const n=l.useRef(null),e=l.useRef(null),i=l.useRef(null),[s,u]=l.useState(null),[m,r]=l.useState(!1),[g,o]=l.useState(!1);l.useEffect(()=>{let A=new Audio;return n.current=A,()=>{e.current?.close(),A.pause(),A.remove(),n.current=null}},[]),l.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:x}=A;return n.current.addEventListener("playing",()=>{S.hide("music-error")},{signal:x}),()=>A.abort()},[]),l.useEffect(()=>{if(!n.current)return;const A=new AbortController,{signal:x}=A;return n.current.addEventListener("ended",()=>{if(!s)return;const C=Ce;let k=C.indexOf(s);if(k==-1)return;let v=k+1;v>=C.length&&(v=0);let c=C[v];c&&u(c)},{signal:x}),()=>A.abort()},[s]),l.useEffect(()=>{if(s)return S.show({id:"music-nowplaying",title:a.jsx(L,{en:"Now Playing",tr:"Şimdi Çalıyor"}),message:s.title}),()=>void S.hide("music-nowplaying");S.hide("music-nowplaying")},[s]);const y=()=>{n.current?.play().then(()=>{e.current=new AudioContext;let A=e.current.createMediaElementSource(n.current);i.current=e.current.createAnalyser(),A.connect(i.current),A.connect(e.current.destination)}).catch(A=>{if(A instanceof DOMException&&A.name=="NotAllowedError"){S.show({id:"music-error",message:a.jsx(L,{en:"Can't play music, please click anywhere",tr:"Müzik çalınamıyor, herhangi bir yere tıklayın"}),autoClose:!1,position:"top-center",color:"yellow"});const x=()=>y();window.addEventListener("click",x,{once:!0})}})};return l.useEffect(()=>{n.current&&(n.current.pause(),n.current.src=s?`/assets/music/${s.file}`:"",s&&y())},[s]),a.jsx(ke.Provider,{value:{ref:n,loading:m,playing:g,currentSong:s,analyser:i,audioContext:e,changeCurrentSong:u},children:t})},be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAALRJREFUOBHtk0sSgCAMQ8Hx/ldWBFNDqfxGdrrpN4/IqHOLHv/CPag/tWOJGAq+3mvumAJW0QLSOG7sOCxfzgrBpN3IBPgVquHsFDNEwELtNzS/jnsvsObUYixz/IPlupddBX166Qe5jhz9AhgS5LFkx2oubzWSCEMSUothSWjIqRJnJTuGJltAsxELTdEggBiW5B4qkSrTkuUYbFOAoX3GM+0Ra8NQV7XVIQghanivjhAfpSe9CxcmJTWuYwAAAABJRU5ErkJggg==",Ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAAAAAAAAPlDu38AAAAHdElNRQfpCAoOASJktxbgAAAA6UlEQVQ4y9WTIQ7CQBBFXwmqWGpBo6u5CdwBzQHQWDTcBF2NBguWWjAz4bMM7Ur4yaZN+/flZaeFX0/hN4/XszUwAu7ARks5nRS4AuZSPgLbRCLsOGgoxQUwA2optwbYCqxOOjfbe0iBEwNWQGmrTuwcpp0ZcPaCAqdSwq6VAXYCrJJOaXs/gFEUSgILkwMsgTGZGeQWc6OGZzkPPctvaW2dkKGo4cVeXq3Yl9a6J9sLxH/KntcgIlM3awy4VFA0lMaAE+KpupkD31KkDzpMHRaaRUPpM6XL7Kthh6kDl10b+z5sNXXgn+cJ6No9ST9X3LMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMDgtMTBUMTQ6MDE6MzQrMDA6MDABpoTaAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTA4LTEwVDE0OjAxOjM0KzAwOjAwcPs8ZgAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0wOC0xMFQxNDowMTozNCswMDowMCfuHbkAAAAASUVORK5CYII=",Me=()=>{const{ref:t}=l.useContext(K);return a.jsxs("div",{id:"SOUL",ref:t,children:[a.jsx("div",{className:"soul heart",style:{backgroundImage:`url("${be}")`}}),a.jsx("div",{className:"soul blur",style:{backgroundImage:`url("${Ee}")`}})]})},Re=({providers:t,children:n})=>a.jsx(a.Fragment,{children:t.reduceRight((e,i)=>a.jsx(i,{children:e}),n)}),Oe=J(function(){return a.jsxs(Re,{providers:[q,$,ee,te,ne,ve,re],children:[a.jsx(we,{}),a.jsx(Me,{}),a.jsx(X,{})]})});export{Oe as default};
